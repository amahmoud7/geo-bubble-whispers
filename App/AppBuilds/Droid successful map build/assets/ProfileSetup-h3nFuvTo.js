import{a as v,j as e,u as x,B as U,s as j,t as N}from"./index-Cak4IDZW.js";import{r as p,u as E}from"./vendor-C9QPK5wj.js";import{C as k,a as D,b as P,c as V,d as S}from"./card-Bp0LqR15.js";import{A as y,a as C,b as F}from"./avatar-CL55SoGP.js";import{I,X as A}from"./icons-Ed5u1gBp.js";import{L as c}from"./label-DaCk0CY-.js";import{I as g}from"./input-Bx49E1sK.js";import{T as L}from"./textarea-Bj8JMMO3.js";import"./supabase-BOJTsyNu.js";import"./ui-WyaPNYUs.js";import"./query-BAKOfRYG.js";import"./maps-CLEk8SoF.js";const B=({previewImage:s,name:r,onImageUpload:m,onClearImage:u})=>{const l=p.useRef(null),{toast:a}=v(),n=()=>{l.current?.click()},b=d=>{const t=d.target.files?.[0];if(!t)return;if(!t.type.match(/image\/(jpeg|jpg|png|gif|webp)/i)){a({title:"Invalid file type",description:"Please upload an image file (JPEG, PNG, GIF, or WEBP)",variant:"destructive"});return}if(t.size>5*1024*1024){a({title:"File too large",description:"Please upload an image smaller than 5MB",variant:"destructive"});return}const i=new FileReader;i.onload=o=>{const h=o.target?.result;m(h)},i.readAsDataURL(t)},f=d=>{d.stopPropagation(),u()};return e.jsxDEV("div",{className:"relative cursor-pointer",onClick:n,children:[e.jsxDEV(y,{className:"h-24 w-24",children:s?e.jsxDEV(C,{src:s},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/AvatarUpload.tsx",lineNumber:63,columnNumber:11},void 0):e.jsxDEV(F,{children:r.charAt(0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/AvatarUpload.tsx",lineNumber:65,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/AvatarUpload.tsx",lineNumber:61,columnNumber:7},void 0),e.jsxDEV("div",{className:"absolute bottom-0 right-0 rounded-full bg-primary p-1",children:e.jsxDEV(I,{className:"h-4 w-4 text-white"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/AvatarUpload.tsx",lineNumber:69,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/AvatarUpload.tsx",lineNumber:68,columnNumber:7},void 0),s&&e.jsxDEV("button",{type:"button",className:"absolute -top-2 -right-2 rounded-full bg-destructive p-1",onClick:f,children:e.jsxDEV(A,{className:"h-3 w-3 text-white"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/AvatarUpload.tsx",lineNumber:78,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/AvatarUpload.tsx",lineNumber:73,columnNumber:9},void 0),e.jsxDEV("input",{type:"file",ref:l,onChange:b,accept:"image/*",className:"hidden"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/AvatarUpload.tsx",lineNumber:82,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/AvatarUpload.tsx",lineNumber:60,columnNumber:5},void 0)},R=({initialImage:s,onImageChange:r,onClearImage:m})=>{const[u,l]=p.useState(s);v();const a=b=>{l(b),r(b)},n=()=>{l(null),m()};return e.jsxDEV("div",{className:"flex items-center justify-center pb-4",children:e.jsxDEV(B,{previewImage:u,name:"",onImageUpload:a,onClearImage:n},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileAvatarUploader.tsx",lineNumber:32,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileAvatarUploader.tsx",lineNumber:31,columnNumber:5},void 0)},T=({formData:s,onFormChange:r})=>e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(c,{htmlFor:"name",children:"Name"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:24,columnNumber:9},void 0),e.jsxDEV(g,{id:"name",name:"name",value:s.name,onChange:r},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:25,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:23,columnNumber:7},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(c,{htmlFor:"username",children:"Username"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:34,columnNumber:9},void 0),e.jsxDEV(g,{id:"username",name:"username",value:s.username,onChange:r},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:35,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:33,columnNumber:7},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(c,{htmlFor:"bio",children:"Bio"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:44,columnNumber:9},void 0),e.jsxDEV(L,{id:"bio",name:"bio",value:s.bio,onChange:r,className:"resize-none",rows:3},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:45,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:43,columnNumber:7},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(c,{htmlFor:"location",children:"Location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:56,columnNumber:9},void 0),e.jsxDEV(g,{id:"location",name:"location",value:s.location,onChange:r},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:57,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:55,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/profile/ProfileForm.tsx",lineNumber:22,columnNumber:5},void 0),Q=()=>{const s=E(),{user:r,loading:m}=x(),[u,l]=p.useState(!1),[a,n]=p.useState({name:"",username:"",bio:"",location:"",avatar:""});p.useEffect(()=>{!m&&!r&&s("/auth")},[r,m,s]);const b=i=>{const{name:o,value:h}=i.target;n(w=>({...w,[o]:h}))},f=i=>{n(o=>({...o,avatar:i}))},d=()=>{n(i=>({...i,avatar:""}))},t=async i=>{if(i.preventDefault(),!!r)try{l(!0);const{error:o}=await j.from("profiles").update({name:a.name,username:a.username||a.name.toLowerCase().replace(/\s+/g,"_"),bio:a.bio,location:a.location,avatar_url:a.avatar,updated_at:new Date().toISOString()}).eq("id",r.id);if(o)throw o;N({title:"Profile setup complete",description:"Your profile has been created successfully."}),s("/home")}catch(o){console.error("Error saving profile:",o),N({title:"Error",description:o.message||"Failed to save profile information",variant:"destructive"})}finally{l(!1)}};return m?e.jsxDEV("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxDEV("p",{children:"Loading..."},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:89,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:88,columnNumber:7},void 0):e.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:e.jsxDEV("div",{className:"w-full max-w-md",children:e.jsxDEV(k,{children:[e.jsxDEV(D,{className:"space-y-1",children:[e.jsxDEV(P,{className:"text-2xl font-bold",children:"Complete Your Profile"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:99,columnNumber:13},void 0),e.jsxDEV(V,{children:"Add some information to help others find and recognize you."},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:100,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:98,columnNumber:11},void 0),e.jsxDEV(S,{children:e.jsxDEV("form",{onSubmit:t,className:"space-y-6",children:[e.jsxDEV("div",{className:"flex justify-center",children:e.jsxDEV(R,{initialImage:a.avatar,onImageChange:f,onClearImage:d},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:107,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:106,columnNumber:15},void 0),e.jsxDEV(T,{formData:a,onFormChange:b},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:114,columnNumber:15},void 0),e.jsxDEV(U,{type:"submit",className:"w-full",disabled:u,children:u?"Saving...":"Complete Setup"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:119,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:105,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:104,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:97,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:96,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/ProfileSetup.tsx",lineNumber:95,columnNumber:5},void 0)};export{Q as default};
