import{j as e,B as _,t as y,c as ve,u as Ae,s as G,a as _r,b as qs,d as Hs}from"./index-Cak4IDZW.js";import{R as xe,r as d,f as Ys}from"./vendor-C9QPK5wj.js";import{M as cs,I as $r,G as Gs,O as $e}from"./maps-CLEk8SoF.js";import{I as Me}from"./input-Bx49E1sK.js";import{D as Rr,a as Fr,b as Or,c as Ls}from"./dropdown-menu-C9GTHY1B.js";import{S as Ws,F as Br,L as zr,N as bs,X as we,e as qr,b as he,f as Hr,A as Yr,g as Gr,U as Wr,a as as,h as Kr,i as Zr,P as os,j as Qr,k as Ks,V as ge,I as Zs,l as Qs,G as Xs,m as Xr,E as Jr,n as Ge,o as ea,R as Be,p as Is,M as ze,q as ts,r as qe,s as Js,t as Ce,u as er,v as Ve,W as sa,w as ra,x as ns,T as sr,H as Ts,y as As,z as aa,B as ds,D as oa,J as ta,K as na,O as ia,Q as la,Y as ma,Z as is,_ as rr,$ as ua,a0 as ca,C as Ps,a1 as De,a2 as ba}from"./icons-Ed5u1gBp.js";import{e as pe,g as da,a as pa,M as ha,u as ar}from"./useMessages-6Vlt4hqW.js";import{C as ie,d as ue,a as ps,b as hs,e as fa}from"./card-Bp0LqR15.js";import{T as ga,a as Na,b as Re,c as Fe}from"./tabs-L5p-AbLP.js";import{B as Ne}from"./badge-mL5Y5NT_.js";import{a as wa,u as xa,b as va,j as ye,P as or,f as ka,n as Ea}from"./ui-WyaPNYUs.js";import{u as Da,S as Va,a as Ua,b as ya,c as ja,d as ss}from"./select-CEe9Hb86.js";import{L as de}from"./label-DaCk0CY-.js";import{T as Sa}from"./textarea-Bj8JMMO3.js";import{A as tr,a as nr,b as ir}from"./avatar-CL55SoGP.js";import{f as lr,D as Ma,a as Ca,b as La,c as Ia}from"./dialog-BkT8nh5t.js";import{u as mr,E as Ta}from"./EventDetailModal-BWkfT3P2.js";import{B as Aa}from"./BottomNavigation-CLXXvX1s.js";import"./supabase-BOJTsyNu.js";import"./query-BAKOfRYG.js";import"./scroll-area-CI2ZTqk6.js";import"./index-BdQq_4o_.js";import"./en-US-BL2atPzf.js";const Pa=({filters:s,onFilterChange:a,onSearchBoxLoad:o,map:t})=>{const i=xe.useRef(null),[n,r]=xe.useState(!1);xe.useEffect(()=>{if(!i.current||!window.google?.maps?.places)return;const l=new google.maps.places.SearchBox(i.current);return o(l),()=>{google.maps.event.clearInstanceListeners(l)}},[o]);const m=()=>{r(!0),navigator.geolocation?navigator.geolocation.getCurrentPosition(l=>{const{latitude:c,longitude:x}=l.coords;if(t){const u=new google.maps.LatLng(c,x);t.setCenter(u),t.setZoom(16)}r(!1)},l=>{console.error("Error getting location:",l),r(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4}):r(!1)};return e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"absolute inset-x-0 z-30",style:{top:"calc(env(safe-area-inset-top, 24px) + 72px)"},children:e.jsxDEV("div",{className:"px-6",children:e.jsxDEV("div",{className:"relative max-w-md mx-auto",children:e.jsxDEV("div",{className:"relative flex items-center",children:[e.jsxDEV(Me,{ref:i,type:"text",placeholder:"Search places, events, locations...",className:"w-full h-12 pl-12 pr-14 bg-white/95 backdrop-blur-xl shadow-2xl border-0 rounded-3xl text-base placeholder:text-gray-500 focus:bg-white focus:shadow-3xl transition-all duration-300 focus:ring-2 focus:ring-lo-teal/20"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:85,columnNumber:15},void 0),e.jsxDEV(Ws,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:91,columnNumber:15},void 0),e.jsxDEV("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:e.jsxDEV(Rr,{children:[e.jsxDEV(Fr,{asChild:!0,children:e.jsxDEV(_,{size:"icon",variant:"ghost",className:"h-11 w-11 min-h-[44px] min-w-[44px] rounded-full hover:bg-gray-100 transition-colors",children:e.jsxDEV(Br,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:102,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:97,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:96,columnNumber:19},void 0),e.jsxDEV(Or,{className:"w-56 mt-2 shadow-xl border-0 rounded-2xl backdrop-blur-xl bg-white/95",children:[e.jsxDEV("div",{className:"px-3 py-2 border-b border-gray-100",children:e.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:"Content Filters"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:107,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:106,columnNumber:21},void 0),e.jsxDEV(Ls,{checked:s.showPublic,onCheckedChange:l=>a("showPublic",l),className:"px-3 py-3 rounded-xl mx-1 my-1",children:e.jsxDEV("div",{className:"flex items-center space-x-3",children:[e.jsxDEV(zr,{className:"h-4 w-4 text-blue-500"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:117,columnNumber:25},void 0),e.jsxDEV("span",{className:"font-medium",children:"Public Posts"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:118,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:116,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:109,columnNumber:21},void 0),e.jsxDEV(Ls,{checked:s.showFollowers,onCheckedChange:l=>a("showFollowers",l),className:"px-3 py-3 rounded-xl mx-1 my-1",children:e.jsxDEV("div",{className:"flex items-center space-x-3",children:[e.jsxDEV("div",{className:"h-4 w-4 rounded-full bg-gradient-to-r from-purple-500 to-pink-500"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:129,columnNumber:25},void 0),e.jsxDEV("span",{className:"font-medium",children:"Following"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:130,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:128,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:121,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:105,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:95,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:84,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:83,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:82,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:78,columnNumber:7},void 0),e.jsxDEV("div",{className:"absolute bottom-28 right-4 z-20 flex flex-col space-y-3",children:e.jsxDEV(_,{onClick:m,disabled:n,className:"h-14 w-14 bg-white/95 backdrop-blur-xl shadow-2xl border-0 rounded-full hover:bg-white hover:shadow-3xl transition-all duration-300 transform hover:scale-105 active:scale-95",variant:"outline",children:e.jsxDEV(bs,{className:`h-6 w-6 text-gray-700 ${n?"animate-pulse":""}`,fill:n?"currentColor":"none"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:150,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:144,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:142,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/ModernMapControls.tsx",lineNumber:76,columnNumber:5},void 0)},_a=({onCancelStreetView:s,onCreateMessage:a,isInStreetView:o})=>e.jsxDEV("div",{className:"absolute right-8 top-8 z-20 flex flex-col gap-2",children:[e.jsxDEV(_,{onClick:s,className:"flex items-center gap-2 shadow-lg",variant:"destructive",children:[e.jsxDEV(we,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/StreetViewControls.tsx",lineNumber:24,columnNumber:9},void 0),"Exit Street View"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/StreetViewControls.tsx",lineNumber:19,columnNumber:7},void 0),o&&e.jsxDEV(_,{onClick:a,className:"flex items-center gap-2 shadow-lg bg-lo-teal hover:bg-lo-teal/90",variant:"default",children:[e.jsxDEV(qr,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/StreetViewControls.tsx",lineNumber:33,columnNumber:11},void 0),"Drop Lo Here"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/StreetViewControls.tsx",lineNumber:28,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/StreetViewControls.tsx",lineNumber:18,columnNumber:5},void 0),ur=()=>{const[s,a]=d.useState(null),[o,t]=d.useState(null),[i,n]=d.useState(!1),[r,m]=d.useState(!1),[l,c]=d.useState(null),x=d.useRef(null),u=d.useCallback(N=>{a(N);const b=N.getStreetView();x.current=b,b.setOptions({enableCloseButton:!0,imageDateControl:!0,visible:!1,motionTracking:!1,motionTrackingControl:!1,addressControl:!0}),b.addListener("visible_changed",()=>{n(b.getVisible()),m(b.getVisible()),b.getVisible()&&y({title:"Street View activated",description:"You can now drop a Lo in Street View mode"})}),b.addListener("position_changed",()=>{if(b.getVisible()){const w=b.getPosition();w&&c({lat:w.lat(),lng:w.lng()})}}),b.addListener("click",w=>{if(b.getVisible()&&w.latLng){const f={lat:w.latLng.lat(),lng:w.latLng.lng()};pe.emit("streetViewClick",f)}}),b.addListener("pano_changed",()=>{if(b.getVisible()){const w=b.getPosition();w&&c({lat:w.lat(),lng:w.lng()})}})},[]),h=d.useCallback(()=>{s&&(s.getStreetView().setVisible(!1),n(!1),m(!1),c(null))},[s]),v=d.useCallback(N=>{if(!s)return;n(!0),new google.maps.StreetViewService().getPanorama({location:new google.maps.LatLng(N.lat,N.lng),radius:50},(w,f)=>{if(f===google.maps.StreetViewStatus.OK){const D=s.getStreetView();D.setPosition(new google.maps.LatLng(N.lat,N.lng)),D.setVisible(!0),m(!0),c(N),y({title:"Street View Loaded",description:"Now viewing location in Street View mode"})}else n(!1),y({title:"Street View not available",description:"Street View isn't available at this location",variant:"destructive"})})},[s]),p=d.useCallback(()=>{a(null)},[]),g=d.useCallback(N=>{console.log("üîç Search box loaded:",N),t(N);const b=N.addListener("places_changed",()=>{console.log("üîç Places changed event triggered");const w=N.getPlaces();if(console.log("üîç Places found:",w?.length||0),!w||w.length===0){console.log("üîç No places returned from search"),y({title:"No results found",description:"Please try a different search term",variant:"destructive"});return}const f=w[0];if(console.log("üîç Selected place:",f.name,f.geometry?.location?.toString()),!f.geometry||!f.geometry.location){console.log("üîç Place has no geometry/location"),y({title:"No location found",description:"Please try a different search term",variant:"destructive"});return}s?(console.log("üîç Updating map to show location"),f.geometry.viewport?s.fitBounds(f.geometry.viewport):(s.setCenter(f.geometry.location),s.setZoom(15)),document.querySelectorAll('input[placeholder*="Search places"]').forEach(E=>E.value=""),y({title:"Location found",description:`Showing results for ${f.name||"selected location"}`})):console.log("üîç Map not available for location update")});return()=>{b&&google.maps.event.removeListener(b)}},[s]);return{map:s,searchBox:o,isAttemptingStreetView:i,isInStreetView:r,streetViewPosition:l,onLoad:u,onUnmount:p,onSearchBoxLoad:g,handleCancelStreetView:h,activateStreetView:v}},cr=()=>{const[s,a]=d.useState(null),[o,t]=d.useState(!1),[,i]=d.useState({});return{selectedMessage:s,setSelectedMessage:a,isCreating:o,setIsCreating:t,handleClose:()=>{a(null),t(!1),i({})}}},$a=({map:s,isPlacingPin:a,setNewPinPosition:o,onCreateMessage:t})=>{const i=Ys(),{setSelectedMessage:n}=cr(),{isAttemptingStreetView:r,isInStreetView:m,handleCancelStreetView:l,activateStreetView:c}=ur();return d.useEffect(()=>{if(i.state&&i.state.activateStreetView&&i.state.center&&s){const{lat:x,lng:u}=i.state.center;setTimeout(()=>{c({lat:x,lng:u}),i.state.messageId&&n(i.state.messageId)},500)}},[i.state,s,c,n]),d.useEffect(()=>pe.on("streetViewClick",x=>{a&&m&&x&&(o(x),y({title:"Street View location selected",description:"Now you can create your Lo at this location"}))}),[a,m,o]),r?e.jsxDEV(_a,{onCancelStreetView:l,onCreateMessage:t,isInStreetView:m},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/StreetViewController.tsx",lineNumber:64,columnNumber:5},void 0):null},Ra=({isPlacingPin:s})=>s?e.jsxDEV("div",{className:"absolute left-1/2 top-8 z-50 transform -translate-x-1/2 bg-background/90 backdrop-blur-sm px-4 py-2 rounded-full shadow-lg flex items-center gap-2 border border-primary/50 pulse",children:[e.jsxDEV(he,{className:"h-5 w-5 text-primary"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/PlacementIndicator.tsx",lineNumber:14,columnNumber:7},void 0),e.jsxDEV("span",{className:"text-sm font-medium",children:"Click anywhere on the map to place your Lo"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/PlacementIndicator.tsx",lineNumber:15,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/PlacementIndicator.tsx",lineNumber:13,columnNumber:5},void 0):null,Fa=({messageType:s,userName:a,mediaUrl:o,isLivestream:t=!1,isLive:i=!1,isEvent:n=!1,size:r=36})=>{const m=da(s),l=a?.charAt(0)||"?",x=s==="text"?`<svg xmlns="http://www.w3.org/2000/svg" width="${r}" height="${r}" viewBox="0 0 ${r} ${r}">
        <circle cx="${r/2}" cy="${r/2}" r="${r/2-2}" fill="${m}" stroke="white" stroke-width="2"/>
        <text x="${r/2}" y="${r/2+4}" font-family="Arial" font-size="${r/3}" fill="white" text-anchor="middle">${l}</text>
      </svg>`:s==="livestream"?i?`<svg xmlns="http://www.w3.org/2000/svg" width="${r+12}" height="${r+12}" viewBox="0 0 ${r+12} ${r+12}">
          <!-- Pulsing outer ring -->
          <circle cx="${(r+12)/2}" cy="${(r+12)/2}" r="${(r+12)/2-1}" fill="${m}" opacity="0.3">
            <animate attributeName="r" values="${(r+12)/2-8};${(r+12)/2-1};${(r+12)/2-8}" dur="2s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values="0.7;0.2;0.7" dur="2s" repeatCount="indefinite"/>
          </circle>
          <!-- Main marker -->
          <circle cx="${(r+12)/2}" cy="${(r+12)/2}" r="${r/2-1}" fill="${m}" stroke="white" stroke-width="2"/>
          <!-- Live indicator -->
          <circle cx="${(r+12)/2}" cy="${(r+12)/2}" r="${r/2-8}" fill="white" opacity="0.9"/>
          <text x="${(r+12)/2}" y="${(r+12)/2+2}" font-family="Arial" font-size="8" fill="${m}" text-anchor="middle">‚óè</text>
          <text x="${(r+12)/2}" y="${(r+12)/2-6}" font-family="Arial" font-size="6" fill="${m}" text-anchor="middle">LIVE</text>
        </svg>`:`<svg xmlns="http://www.w3.org/2000/svg" width="${r+8}" height="${r+8}" viewBox="0 0 ${r+8} ${r+8}">
          <circle cx="${(r+8)/2}" cy="${(r+8)/2}" r="${(r+8)/2-1}" fill="white" stroke="${m}" stroke-width="2"/>
          <circle cx="${(r+8)/2}" cy="${(r+8)/2}" r="${r/2-2}" fill="${m}" opacity="0.9"/>
          <circle cx="${(r+8)/2}" cy="${(r+8)/2}" r="${r/2-6}" fill="white" opacity="0.8"/>
          <text x="${(r+8)/2}" y="${(r+8)/2+2}" font-family="Arial" font-size="8" fill="${m}" text-anchor="middle">‚ñ∂</text>
        </svg>`:s==="event"?`<svg xmlns="http://www.w3.org/2000/svg" width="${r+8}" height="${r+8}" viewBox="0 0 ${r+8} ${r+8}">
        <!-- Outer border with slight glow effect -->
        <circle cx="${(r+8)/2}" cy="${(r+8)/2}" r="${(r+8)/2-1}" fill="white" stroke="${m}" stroke-width="3" opacity="0.9"/>
        <!-- Main marker background -->
        <circle cx="${(r+8)/2}" cy="${(r+8)/2}" r="${r/2-1}" fill="${m}" opacity="0.95"/>
        <!-- Calendar icon background -->
        <rect x="${(r+8)/2-8}" y="${(r+8)/2-8}" width="16" height="16" rx="2" fill="white" opacity="0.9"/>
        <!-- Calendar top -->
        <rect x="${(r+8)/2-6}" y="${(r+8)/2-7}" width="12" height="2" fill="${m}"/>
        <!-- Calendar body -->
        <rect x="${(r+8)/2-6}" y="${(r+8)/2-4}" width="12" height="10" fill="white" stroke="${m}" stroke-width="0.5"/>
        <!-- Calendar dots -->
        <circle cx="${(r+8)/2-3}" cy="${(r+8)/2-1}" r="1" fill="${m}"/>
        <circle cx="${(r+8)/2}" cy="${(r+8)/2-1}" r="1" fill="${m}"/>
        <circle cx="${(r+8)/2+3}" cy="${(r+8)/2-1}" r="1" fill="${m}"/>
        <circle cx="${(r+8)/2-3}" cy="${(r+8)/2+2}" r="1" fill="${m}"/>
        <circle cx="${(r+8)/2}" cy="${(r+8)/2+2}" r="1" fill="${m}"/>
      </svg>`:`<svg xmlns="http://www.w3.org/2000/svg" width="${r+8}" height="${r+8}" viewBox="0 0 ${r+8} ${r+8}">
      <!-- Outer border -->
      <circle cx="${(r+8)/2}" cy="${(r+8)/2}" r="${(r+8)/2-1}" fill="white" stroke="${m}" stroke-width="2"/>
      <!-- Inner content area -->
      <circle cx="${(r+8)/2}" cy="${(r+8)/2}" r="${r/2-2}" fill="${m}" opacity="0.9"/>
      <!-- Preview placeholder (will be replaced with actual image) -->
      <circle cx="${(r+8)/2}" cy="${(r+8)/2}" r="${r/2-6}" fill="white" opacity="0.8"/>
      <text x="${(r+8)/2}" y="${(r+8)/2+2}" font-family="Arial" font-size="8" fill="${m}" text-anchor="middle">${s==="video"?"‚ñ∂":"üì∑"}</text>
    </svg>`;return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(x)},br=({messages:s,onMessageClick:a})=>(console.log(`üó∫Ô∏è MessageMarkers: Rendering ${s.length} messages`),s.length>0&&console.log("üìç First message position:",s[0].position),e.jsxDEV(e.Fragment,{children:s.map(o=>{const t=o.isEvent||!1,i=pa(o.mediaUrl,o.isLivestream,t),n=o.user?.name||"Unknown",r=o.isLivestream||!1,m=o.isLive||!1,l=Fa({messageType:i,userName:n,mediaUrl:o.mediaUrl,isLivestream:r,isLive:m,isEvent:t,size:36}),c=i==="text"?36:i==="livestream"&&m||i==="event"?48:44,x=c/2;return e.jsxDEV(cs,{position:{lat:o.position.lat,lng:o.position.lng},onClick:()=>a(o.id),icon:{url:l,anchor:new google.maps.Point(x,x),scaledSize:new google.maps.Size(c,c)},visible:!0,zIndex:o.id.startsWith("new-")?100:2,animation:o.id.startsWith("new-")?google.maps.Animation.BOUNCE:google.maps.Animation.DROP},o.id,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/MessageMarkers.tsx",lineNumber:57,columnNumber:11},void 0)})},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/MessageMarkers.tsx",lineNumber:33,columnNumber:5},void 0));var fs="Switch",[Oa,Nt]=wa(fs),[Ba,za]=Oa(fs),dr=d.forwardRef((s,a)=>{const{__scopeSwitch:o,name:t,checked:i,defaultChecked:n,required:r,disabled:m,value:l="on",onCheckedChange:c,form:x,...u}=s,[h,v]=d.useState(null),p=xa(a,f=>v(f)),g=d.useRef(!1),N=h?x||!!h.closest("form"):!0,[b=!1,w]=va({prop:i,defaultProp:n,onChange:c});return ye.jsxs(Ba,{scope:o,checked:b,disabled:m,children:[ye.jsx(or.button,{type:"button",role:"switch","aria-checked":b,"aria-required":r,"data-state":fr(b),"data-disabled":m?"":void 0,disabled:m,value:l,...u,ref:p,onClick:ka(s.onClick,f=>{w(D=>!D),N&&(g.current=f.isPropagationStopped(),g.current||f.stopPropagation())})}),N&&ye.jsx(qa,{control:h,bubbles:!g.current,name:t,value:l,checked:b,required:r,disabled:m,form:x,style:{transform:"translateX(-100%)"}})]})});dr.displayName=fs;var pr="SwitchThumb",hr=d.forwardRef((s,a)=>{const{__scopeSwitch:o,...t}=s,i=za(pr,o);return ye.jsx(or.span,{"data-state":fr(i.checked),"data-disabled":i.disabled?"":void 0,...t,ref:a})});hr.displayName=pr;var qa=s=>{const{control:a,checked:o,bubbles:t=!0,...i}=s,n=d.useRef(null),r=Da(o),m=Ea(a);return d.useEffect(()=>{const l=n.current,c=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(c,"checked").set;if(r!==o&&u){const h=new Event("click",{bubbles:t});u.call(l,o),l.dispatchEvent(h)}},[r,o,t]),ye.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:o,...i,tabIndex:-1,ref:n,style:{...s.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function fr(s){return s?"checked":"unchecked"}var gr=dr,Ha=hr;const gs=d.forwardRef(({className:s,...a},o)=>e.jsxDEV(gr,{className:ve("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...a,ref:o,children:e.jsxDEV(Ha,{className:ve("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/switch.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/switch.tsx",lineNumber:10,columnNumber:3},void 0));gs.displayName=gr.displayName;const Ya=({isPublic:s,onToggle:a})=>e.jsxDEV("div",{className:"flex items-center justify-between pt-2",children:[e.jsxDEV("div",{className:"space-y-0.5",children:[e.jsxDEV(de,{htmlFor:"public-toggle",children:"Make public"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/PrivacyToggle.tsx",lineNumber:15,columnNumber:9},void 0),e.jsxDEV("div",{className:"text-xs text-muted-foreground",children:s?"Anyone can see this message":"Only followers can see this message"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/PrivacyToggle.tsx",lineNumber:16,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/PrivacyToggle.tsx",lineNumber:14,columnNumber:7},void 0),e.jsxDEV(gs,{id:"public-toggle",checked:s,onCheckedChange:a},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/PrivacyToggle.tsx",lineNumber:20,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/PrivacyToggle.tsx",lineNumber:13,columnNumber:5},void 0),Ga=({isPinPlaced:s,onMovePin:a})=>e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("div",{className:"flex-1 flex items-center text-sm text-muted-foreground",children:[e.jsxDEV(he,{className:"h-4 w-4 mr-1"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LocationInfo.tsx",lineNumber:15,columnNumber:9},void 0),s?e.jsxDEV("span",{children:"Pin placed! Move it to adjust location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LocationInfo.tsx",lineNumber:17,columnNumber:11},void 0):e.jsxDEV("span",{children:"Place your pin on the map"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LocationInfo.tsx",lineNumber:19,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LocationInfo.tsx",lineNumber:14,columnNumber:7},void 0),s&&a&&e.jsxDEV(_,{type:"button",variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:a,children:[e.jsxDEV(Hr,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LocationInfo.tsx",lineNumber:30,columnNumber:11},void 0),"Move Pin"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LocationInfo.tsx",lineNumber:23,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LocationInfo.tsx",lineNumber:13,columnNumber:5},void 0);function Wa(s){return Object.prototype.toString.call(s)==="[object Object]"}function _s(s){return Wa(s)||Array.isArray(s)}function Ka(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function Ns(s,a){const o=Object.keys(s),t=Object.keys(a);if(o.length!==t.length)return!1;const i=JSON.stringify(Object.keys(s.breakpoints||{})),n=JSON.stringify(Object.keys(a.breakpoints||{}));return i!==n?!1:o.every(r=>{const m=s[r],l=a[r];return typeof m=="function"?`${m}`==`${l}`:!_s(m)||!_s(l)?m===l:Ns(m,l)})}function $s(s){return s.concat().sort((a,o)=>a.name>o.name?1:-1).map(a=>a.options)}function Za(s,a){if(s.length!==a.length)return!1;const o=$s(s),t=$s(a);return o.every((i,n)=>{const r=t[n];return Ns(i,r)})}function ws(s){return typeof s=="number"}function ls(s){return typeof s=="string"}function We(s){return typeof s=="boolean"}function Rs(s){return Object.prototype.toString.call(s)==="[object Object]"}function J(s){return Math.abs(s)}function xs(s){return Math.sign(s)}function je(s,a){return J(s-a)}function Qa(s,a){if(s===0||a===0||J(s)<=J(a))return 0;const o=je(J(s),J(a));return J(o/s)}function Le(s){return Ie(s).map(Number)}function ce(s){return s[Pe(s)]}function Pe(s){return Math.max(0,s.length-1)}function vs(s,a){return a===Pe(s)}function Fs(s,a=0){return Array.from(Array(s),(o,t)=>a+t)}function Ie(s){return Object.keys(s)}function Nr(s,a){return[s,a].reduce((o,t)=>(Ie(t).forEach(i=>{const n=o[i],r=t[i],m=Rs(n)&&Rs(r);o[i]=m?Nr(n,r):r}),o),{})}function ms(s,a){return typeof a.MouseEvent<"u"&&s instanceof a.MouseEvent}function Xa(s,a){const o={start:t,center:i,end:n};function t(){return 0}function i(l){return n(l)/2}function n(l){return a-l}function r(l,c){return ls(s)?o[s](l):s(a,l,c)}return{measure:r}}function Te(){let s=[];function a(i,n,r,m={passive:!0}){let l;if("addEventListener"in i)i.addEventListener(n,r,m),l=()=>i.removeEventListener(n,r,m);else{const c=i;c.addListener(r),l=()=>c.removeListener(r)}return s.push(l),t}function o(){s=s.filter(i=>i())}const t={add:a,clear:o};return t}function Ja(s,a,o,t){const i=Te(),n=1e3/60;let r=null,m=0,l=0;function c(){i.add(s,"visibilitychange",()=>{s.hidden&&p()})}function x(){v(),i.clear()}function u(N){if(!l)return;r||(r=N);const b=N-r;for(r=N,m+=b;m>=n;)o(n),m-=n;const w=m/n;t(w),l&&a.requestAnimationFrame(u)}function h(){l||(l=a.requestAnimationFrame(u))}function v(){a.cancelAnimationFrame(l),r=null,m=0,l=0}function p(){r=null,m=0}return{init:c,destroy:x,start:h,stop:v,update:()=>o(n),render:t}}function eo(s,a){const o=a==="rtl",t=s==="y",i=t?"y":"x",n=t?"x":"y",r=!t&&o?-1:1,m=x(),l=u();function c(p){const{height:g,width:N}=p;return t?g:N}function x(){return t?"top":o?"right":"left"}function u(){return t?"bottom":o?"left":"right"}function h(p){return p*r}return{scroll:i,cross:n,startEdge:m,endEdge:l,measureSize:c,direction:h}}function ke(s=0,a=0){const o=J(s-a);function t(c){return c<s}function i(c){return c>a}function n(c){return t(c)||i(c)}function r(c){return n(c)?t(c)?s:a:c}function m(c){return o?c-o*Math.ceil((c-a)/o):c}return{length:o,max:a,min:s,constrain:r,reachedAny:n,reachedMax:i,reachedMin:t,removeOffset:m}}function wr(s,a,o){const{constrain:t}=ke(0,s),i=s+1;let n=r(a);function r(h){return o?J((i+h)%i):t(h)}function m(){return n}function l(h){return n=r(h),u}function c(h){return x().set(m()+h)}function x(){return wr(s,m(),o)}const u={get:m,set:l,add:c,clone:x};return u}function so(s,a,o,t,i,n,r,m,l,c,x,u,h,v,p,g,N,b,w){const{cross:f,direction:D}=s,E=["INPUT","SELECT","TEXTAREA"],k={passive:!1},V=Te(),C=Te(),U=ke(50,225).constrain(v.measure(20)),$={mouse:300,touch:400},P={mouse:500,touch:600},O=p?43:25;let R=!1,W=0,F=0,L=!1,T=!1,Y=!1,Q=!1;function re(S){if(!w)return;function q(te){(We(w)||w(S,te))&&I(te)}const se=a;V.add(se,"dragstart",te=>te.preventDefault(),k).add(se,"touchmove",()=>{},k).add(se,"touchend",()=>{}).add(se,"touchstart",q).add(se,"mousedown",q).add(se,"touchcancel",z).add(se,"contextmenu",z).add(se,"click",X,!0)}function H(){V.clear(),C.clear()}function ee(){const S=Q?o:a;C.add(S,"touchmove",j,k).add(S,"touchend",z).add(S,"mousemove",j,k).add(S,"mouseup",z)}function K(S){const q=S.nodeName||"";return E.includes(q)}function M(){return(p?P:$)[Q?"mouse":"touch"]}function B(S,q){const se=u.add(xs(S)*-1),te=x.byDistance(S,!p).distance;return p||J(S)<U?te:N&&q?te*.5:x.byIndex(se.get(),0).distance}function I(S){const q=ms(S,t);Q=q,Y=p&&q&&!S.buttons&&R,R=je(i.get(),r.get())>=2,!(q&&S.button!==0)&&(K(S.target)||(L=!0,n.pointerDown(S),c.useFriction(0).useDuration(0),i.set(r),ee(),W=n.readPoint(S),F=n.readPoint(S,f),h.emit("pointerDown")))}function j(S){if(!ms(S,t)&&S.touches.length>=2)return z(S);const se=n.readPoint(S),te=n.readPoint(S,f),le=je(se,W),me=je(te,F);if(!T&&!Q&&(!S.cancelable||(T=le>me,!T)))return z(S);const be=n.pointerMove(S);le>g&&(Y=!0),c.useFriction(.3).useDuration(.75),m.start(),i.add(D(be)),S.preventDefault()}function z(S){const se=x.byDistance(0,!1).index!==u.get(),te=n.pointerUp(S)*M(),le=B(D(te),se),me=Qa(te,le),be=O-10*me,A=b+me/50;T=!1,L=!1,C.clear(),c.useDuration(be).useFriction(A),l.distance(le,!p),Q=!1,h.emit("pointerUp")}function X(S){Y&&(S.stopPropagation(),S.preventDefault(),Y=!1)}function ae(){return L}return{init:re,destroy:H,pointerDown:ae}}function ro(s,a){let t,i;function n(u){return u.timeStamp}function r(u,h){const p=`client${(h||s.scroll)==="x"?"X":"Y"}`;return(ms(u,a)?u:u.touches[0])[p]}function m(u){return t=u,i=u,r(u)}function l(u){const h=r(u)-r(i),v=n(u)-n(t)>170;return i=u,v&&(t=u),h}function c(u){if(!t||!i)return 0;const h=r(i)-r(t),v=n(u)-n(t),p=n(u)-n(i)>170,g=h/v;return v&&!p&&J(g)>.1?g:0}return{pointerDown:m,pointerMove:l,pointerUp:c,readPoint:r}}function ao(){function s(o){const{offsetTop:t,offsetLeft:i,offsetWidth:n,offsetHeight:r}=o;return{top:t,right:i+n,bottom:t+r,left:i,width:n,height:r}}return{measure:s}}function oo(s){function a(t){return s*(t/100)}return{measure:a}}function to(s,a,o,t,i,n,r){const m=[s].concat(t);let l,c,x=[],u=!1;function h(N){return i.measureSize(r.measure(N))}function v(N){if(!n)return;c=h(s),x=t.map(h);function b(w){for(const f of w){if(u)return;const D=f.target===s,E=t.indexOf(f.target),k=D?c:x[E],V=h(D?s:t[E]);if(J(V-k)>=.5){N.reInit(),a.emit("resize");break}}}l=new ResizeObserver(w=>{(We(n)||n(N,w))&&b(w)}),o.requestAnimationFrame(()=>{m.forEach(w=>l.observe(w))})}function p(){u=!0,l&&l.disconnect()}return{init:v,destroy:p}}function no(s,a,o,t,i,n){let r=0,m=0,l=i,c=n,x=s.get(),u=0;function h(k){const V=k/1e3,C=l*V,U=t.get()-s.get(),$=!l;let P=0;return $?(r=0,o.set(t),s.set(t),P=U):(o.set(s),r+=U/C,r*=c,x+=r,s.add(r*V),P=x-u),m=xs(P),u=x,E}function v(){const k=t.get()-a.get();return J(k)<.001}function p(){return l}function g(){return m}function N(){return r}function b(){return f(i)}function w(){return D(n)}function f(k){return l=k,E}function D(k){return c=k,E}const E={direction:g,duration:p,velocity:N,seek:h,settled:v,useBaseFriction:w,useBaseDuration:b,useFriction:D,useDuration:f};return E}function io(s,a,o,t,i){const n=i.measure(10),r=i.measure(50),m=ke(.1,.99);let l=!1;function c(){return!(l||!s.reachedAny(o.get())||!s.reachedAny(a.get()))}function x(v){if(!c())return;const p=s.reachedMin(a.get())?"min":"max",g=J(s[p]-a.get()),N=o.get()-a.get(),b=m.constrain(g/r);o.subtract(N*b),!v&&J(N)<n&&(o.set(s.constrain(o.get())),t.useDuration(25).useBaseFriction())}function u(v){l=!v}return{shouldConstrain:c,constrain:x,toggleActive:u}}function lo(s,a,o,t,i){const n=ke(-a+s,0),r=u(),m=x(),l=h();function c(p,g){return je(p,g)<1}function x(){const p=r[0],g=ce(r),N=r.lastIndexOf(p),b=r.indexOf(g)+1;return ke(N,b)}function u(){return o.map((p,g)=>{const{min:N,max:b}=n,w=n.constrain(p),f=!g,D=vs(o,g);return f?b:D||c(N,w)?N:c(b,w)?b:w}).map(p=>parseFloat(p.toFixed(3)))}function h(){if(a<=s+i)return[n.max];if(t==="keepSnaps")return r;const{min:p,max:g}=m;return r.slice(p,g)}return{snapsContained:l,scrollContainLimit:m}}function mo(s,a,o){const t=a[0],i=o?t-s:ce(a);return{limit:ke(i,t)}}function uo(s,a,o,t){const n=a.min+.1,r=a.max+.1,{reachedMin:m,reachedMax:l}=ke(n,r);function c(h){return h===1?l(o.get()):h===-1?m(o.get()):!1}function x(h){if(!c(h))return;const v=s*(h*-1);t.forEach(p=>p.add(v))}return{loop:x}}function co(s){const{max:a,length:o}=s;function t(n){const r=n-a;return o?r/-o:0}return{get:t}}function bo(s,a,o,t,i){const{startEdge:n,endEdge:r}=s,{groupSlides:m}=i,l=u().map(a.measure),c=h(),x=v();function u(){return m(t).map(g=>ce(g)[r]-g[0][n]).map(J)}function h(){return t.map(g=>o[n]-g[n]).map(g=>-J(g))}function v(){return m(c).map(g=>g[0]).map((g,N)=>g+l[N])}return{snaps:c,snapsAligned:x}}function po(s,a,o,t,i,n){const{groupSlides:r}=i,{min:m,max:l}=t,c=x();function x(){const h=r(n),v=!s||a==="keepSnaps";return o.length===1?[n]:v?h:h.slice(m,l).map((p,g,N)=>{const b=!g,w=vs(N,g);if(b){const f=ce(N[0])+1;return Fs(f)}if(w){const f=Pe(n)-ce(N)[0]+1;return Fs(f,ce(N)[0])}return p})}return{slideRegistry:c}}function ho(s,a,o,t,i){const{reachedAny:n,removeOffset:r,constrain:m}=t;function l(p){return p.concat().sort((g,N)=>J(g)-J(N))[0]}function c(p){const g=s?r(p):m(p),N=a.map((w,f)=>({diff:x(w-g,0),index:f})).sort((w,f)=>J(w.diff)-J(f.diff)),{index:b}=N[0];return{index:b,distance:g}}function x(p,g){const N=[p,p+o,p-o];if(!s)return p;if(!g)return l(N);const b=N.filter(w=>xs(w)===g);return b.length?l(b):ce(N)-o}function u(p,g){const N=a[p]-i.get(),b=x(N,g);return{index:p,distance:b}}function h(p,g){const N=i.get()+p,{index:b,distance:w}=c(N),f=!s&&n(N);if(!g||f)return{index:b,distance:p};const D=a[b]-w,E=p+x(D,0);return{index:b,distance:E}}return{byDistance:h,byIndex:u,shortcut:x}}function fo(s,a,o,t,i,n,r){function m(u){const h=u.distance,v=u.index!==a.get();n.add(h),h&&(t.duration()?s.start():(s.update(),s.render(1),s.update())),v&&(o.set(a.get()),a.set(u.index),r.emit("select"))}function l(u,h){const v=i.byDistance(u,h);m(v)}function c(u,h){const v=a.clone().set(u),p=i.byIndex(v.get(),h);m(p)}return{distance:l,index:c}}function go(s,a,o,t,i,n,r,m){const l={passive:!0,capture:!0};let c=0;function x(v){if(!m)return;function p(g){if(new Date().getTime()-c>10)return;r.emit("slideFocusStart"),s.scrollLeft=0;const w=o.findIndex(f=>f.includes(g));ws(w)&&(i.useDuration(0),t.index(w,0),r.emit("slideFocus"))}n.add(document,"keydown",u,!1),a.forEach((g,N)=>{n.add(g,"focus",b=>{(We(m)||m(v,b))&&p(N)},l)})}function u(v){v.code==="Tab"&&(c=new Date().getTime())}return{init:x}}function Ue(s){let a=s;function o(){return a}function t(l){a=r(l)}function i(l){a+=r(l)}function n(l){a-=r(l)}function r(l){return ws(l)?l:l.get()}return{get:o,set:t,add:i,subtract:n}}function xr(s,a){const o=s.scroll==="x"?n:r,t=a.style;let i=!1;function n(u){return`translate3d(${u}px,0px,0px)`}function r(u){return`translate3d(0px,${u}px,0px)`}function m(u){i||(t.transform=o(s.direction(u)))}function l(u){i=!u}function c(){i||(t.transform="",a.getAttribute("style")||a.removeAttribute("style"))}return{clear:c,to:m,toggleActive:l}}function No(s,a,o,t,i,n,r,m,l){const x=Le(i),u=Le(i).reverse(),h=b().concat(w());function v(V,C){return V.reduce((U,$)=>U-i[$],C)}function p(V,C){return V.reduce((U,$)=>v(U,C)>0?U.concat([$]):U,[])}function g(V){return n.map((C,U)=>({start:C-t[U]+.5+V,end:C+a-.5+V}))}function N(V,C,U){const $=g(C);return V.map(P=>{const O=U?0:-o,R=U?o:0,W=U?"end":"start",F=$[P][W];return{index:P,loopPoint:F,slideLocation:Ue(-1),translate:xr(s,l[P]),target:()=>m.get()>F?O:R}})}function b(){const V=r[0],C=p(u,V);return N(C,o,!1)}function w(){const V=a-r[0]-1,C=p(x,V);return N(C,-o,!0)}function f(){return h.every(({index:V})=>{const C=x.filter(U=>U!==V);return v(C,a)<=.1})}function D(){h.forEach(V=>{const{target:C,translate:U,slideLocation:$}=V,P=C();P!==$.get()&&(U.to(P),$.set(P))})}function E(){h.forEach(V=>V.translate.clear())}return{canLoop:f,clear:E,loop:D,loopPoints:h}}function wo(s,a,o){let t,i=!1;function n(l){if(!o)return;function c(x){for(const u of x)if(u.type==="childList"){l.reInit(),a.emit("slidesChanged");break}}t=new MutationObserver(x=>{i||(We(o)||o(l,x))&&c(x)}),t.observe(s,{childList:!0})}function r(){t&&t.disconnect(),i=!0}return{init:n,destroy:r}}function xo(s,a,o,t){const i={};let n=null,r=null,m,l=!1;function c(){m=new IntersectionObserver(p=>{l||(p.forEach(g=>{const N=a.indexOf(g.target);i[N]=g}),n=null,r=null,o.emit("slidesInView"))},{root:s.parentElement,threshold:t}),a.forEach(p=>m.observe(p))}function x(){m&&m.disconnect(),l=!0}function u(p){return Ie(i).reduce((g,N)=>{const b=parseInt(N),{isIntersecting:w}=i[b];return(p&&w||!p&&!w)&&g.push(b),g},[])}function h(p=!0){if(p&&n)return n;if(!p&&r)return r;const g=u(p);return p&&(n=g),p||(r=g),g}return{init:c,destroy:x,get:h}}function vo(s,a,o,t,i,n){const{measureSize:r,startEdge:m,endEdge:l}=s,c=o[0]&&i,x=p(),u=g(),h=o.map(r),v=N();function p(){if(!c)return 0;const w=o[0];return J(a[m]-w[m])}function g(){if(!c)return 0;const w=n.getComputedStyle(ce(t));return parseFloat(w.getPropertyValue(`margin-${l}`))}function N(){return o.map((w,f,D)=>{const E=!f,k=vs(D,f);return E?h[f]+x:k?h[f]+u:D[f+1][m]-w[m]}).map(J)}return{slideSizes:h,slideSizesWithGaps:v,startGap:x,endGap:u}}function ko(s,a,o,t,i,n,r,m,l){const{startEdge:c,endEdge:x,direction:u}=s,h=ws(o);function v(b,w){return Le(b).filter(f=>f%w===0).map(f=>b.slice(f,f+w))}function p(b){return b.length?Le(b).reduce((w,f,D)=>{const E=ce(w)||0,k=E===0,V=f===Pe(b),C=i[c]-n[E][c],U=i[c]-n[f][x],$=!t&&k?u(r):0,P=!t&&V?u(m):0,O=J(U-P-(C+$));return D&&O>a+l&&w.push(f),V&&w.push(b.length),w},[]).map((w,f,D)=>{const E=Math.max(D[f-1]||0);return b.slice(E,w)}):[]}function g(b){return h?v(b,o):p(b)}return{groupSlides:g}}function Eo(s,a,o,t,i,n,r){const{align:m,axis:l,direction:c,startIndex:x,loop:u,duration:h,dragFree:v,dragThreshold:p,inViewThreshold:g,slidesToScroll:N,skipSnaps:b,containScroll:w,watchResize:f,watchSlides:D,watchDrag:E,watchFocus:k}=n,V=2,C=ao(),U=C.measure(a),$=o.map(C.measure),P=eo(l,c),O=P.measureSize(U),R=oo(O),W=Xa(m,O),F=!u&&!!w,L=u||!!w,{slideSizes:T,slideSizesWithGaps:Y,startGap:Q,endGap:re}=vo(P,U,$,o,L,i),H=ko(P,O,N,u,U,$,Q,re,V),{snaps:ee,snapsAligned:K}=bo(P,W,U,$,H),M=-ce(ee)+ce(Y),{snapsContained:B,scrollContainLimit:I}=lo(O,M,K,w,V),j=F?B:K,{limit:z}=mo(M,j,u),X=wr(Pe(j),x,u),ae=X.clone(),Z=Le(o),S=({dragHandler:fe,scrollBody:Xe,scrollBounds:Je,options:{loop:_e}},es)=>{_e||Je.constrain(fe.pointerDown()),Xe.seek(es)},q=({scrollBody:fe,translate:Xe,location:Je,offsetLocation:_e,scrollLooper:es,slideLooper:Cr,dragHandler:Lr,animation:Ir,eventHandler:ys,scrollBounds:Tr,options:{loop:js}},Ss)=>{const Ms=fe.settled(),Ar=!Tr.shouldConstrain(),Cs=js?Ms:Ms&&Ar;Cs&&!Lr.pointerDown()&&(Ir.stop(),ys.emit("settle")),Cs||ys.emit("scroll");const Pr=Je.get()*Ss+be.get()*(1-Ss);_e.set(Pr),js&&(es.loop(fe.direction()),Cr.loop()),Xe.to(_e.get())},se=Ja(t,i,fe=>S(Qe,fe),fe=>q(Qe,fe)),te=.68,le=j[X.get()],me=Ue(le),be=Ue(le),A=Ue(le),oe=Ue(le),ne=no(me,A,be,oe,h,te),Ee=ho(u,j,M,z,oe),Ze=fo(se,X,ae,ne,Ee,oe,r),Ds=co(z),Vs=Te(),Sr=xo(a,o,r,g),{slideRegistry:Us}=po(F,w,j,I,H,Z),Mr=go(s,o,Us,Ze,ne,Vs,r,k),Qe={ownerDocument:t,ownerWindow:i,eventHandler:r,containerRect:U,slideRects:$,animation:se,axis:P,dragHandler:so(P,s,t,i,oe,ro(P,i),me,se,Ze,ne,Ee,X,r,R,v,p,b,te,E),eventStore:Vs,percentOfView:R,index:X,indexPrevious:ae,limit:z,location:me,offsetLocation:A,previousLocation:be,options:n,resizeHandler:to(a,r,i,o,P,f,C),scrollBody:ne,scrollBounds:io(z,A,oe,ne,R),scrollLooper:uo(M,z,A,[me,A,be,oe]),scrollProgress:Ds,scrollSnapList:j.map(Ds.get),scrollSnaps:j,scrollTarget:Ee,scrollTo:Ze,slideLooper:No(P,O,M,T,Y,ee,j,A,o),slideFocus:Mr,slidesHandler:wo(a,r,D),slidesInView:Sr,slideIndexes:Z,slideRegistry:Us,slidesToScroll:H,target:oe,translate:xr(P,a)};return Qe}function Do(){let s={},a;function o(c){a=c}function t(c){return s[c]||[]}function i(c){return t(c).forEach(x=>x(a,c)),l}function n(c,x){return s[c]=t(c).concat([x]),l}function r(c,x){return s[c]=t(c).filter(u=>u!==x),l}function m(){s={}}const l={init:o,emit:i,off:r,on:n,clear:m};return l}const Vo={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function Uo(s){function a(n,r){return Nr(n,r||{})}function o(n){const r=n.breakpoints||{},m=Ie(r).filter(l=>s.matchMedia(l).matches).map(l=>r[l]).reduce((l,c)=>a(l,c),{});return a(n,m)}function t(n){return n.map(r=>Ie(r.breakpoints||{})).reduce((r,m)=>r.concat(m),[]).map(s.matchMedia)}return{mergeOptions:a,optionsAtMedia:o,optionsMediaQueries:t}}function yo(s){let a=[];function o(n,r){return a=r.filter(({options:m})=>s.optionsAtMedia(m).active!==!1),a.forEach(m=>m.init(n,s)),r.reduce((m,l)=>Object.assign(m,{[l.name]:l}),{})}function t(){a=a.filter(n=>n.destroy())}return{init:o,destroy:t}}function He(s,a,o){const t=s.ownerDocument,i=t.defaultView,n=Uo(i),r=yo(n),m=Te(),l=Do(),{mergeOptions:c,optionsAtMedia:x,optionsMediaQueries:u}=n,{on:h,off:v,emit:p}=l,g=P;let N=!1,b,w=c(Vo,He.globalOptions),f=c(w),D=[],E,k,V;function C(){const{container:Z,slides:S}=f;k=(ls(Z)?s.querySelector(Z):Z)||s.children[0];const se=ls(S)?k.querySelectorAll(S):S;V=[].slice.call(se||k.children)}function U(Z){const S=Eo(s,k,V,t,i,Z,l);if(Z.loop&&!S.slideLooper.canLoop()){const q=Object.assign({},Z,{loop:!1});return U(q)}return S}function $(Z,S){N||(w=c(w,Z),f=x(w),D=S||D,C(),b=U(f),u([w,...D.map(({options:q})=>q)]).forEach(q=>m.add(q,"change",P)),f.active&&(b.translate.to(b.location.get()),b.animation.init(),b.slidesInView.init(),b.slideFocus.init(ae),b.eventHandler.init(ae),b.resizeHandler.init(ae),b.slidesHandler.init(ae),b.options.loop&&b.slideLooper.loop(),k.offsetParent&&V.length&&b.dragHandler.init(ae),E=r.init(ae,D)))}function P(Z,S){const q=H();O(),$(c({startIndex:q},Z),S),l.emit("reInit")}function O(){b.dragHandler.destroy(),b.eventStore.clear(),b.translate.clear(),b.slideLooper.clear(),b.resizeHandler.destroy(),b.slidesHandler.destroy(),b.slidesInView.destroy(),b.animation.destroy(),r.destroy(),m.clear()}function R(){N||(N=!0,m.clear(),O(),l.emit("destroy"),l.clear())}function W(Z,S,q){!f.active||N||(b.scrollBody.useBaseFriction().useDuration(S===!0?0:f.duration),b.scrollTo.index(Z,q||0))}function F(Z){const S=b.index.add(1).get();W(S,Z,-1)}function L(Z){const S=b.index.add(-1).get();W(S,Z,1)}function T(){return b.index.add(1).get()!==H()}function Y(){return b.index.add(-1).get()!==H()}function Q(){return b.scrollSnapList}function re(){return b.scrollProgress.get(b.location.get())}function H(){return b.index.get()}function ee(){return b.indexPrevious.get()}function K(){return b.slidesInView.get()}function M(){return b.slidesInView.get(!1)}function B(){return E}function I(){return b}function j(){return s}function z(){return k}function X(){return V}const ae={canScrollNext:T,canScrollPrev:Y,containerNode:z,internalEngine:I,destroy:R,off:v,on:h,emit:p,plugins:B,previousScrollSnap:ee,reInit:g,rootNode:j,scrollNext:F,scrollPrev:L,scrollProgress:re,scrollSnapList:Q,scrollTo:W,selectedScrollSnap:H,slideNodes:X,slidesInView:K,slidesNotInView:M};return $(a,o),setTimeout(()=>l.emit("init"),0),ae}He.globalOptions=void 0;function ks(s={},a=[]){const o=d.useRef(s),t=d.useRef(a),[i,n]=d.useState(),[r,m]=d.useState(),l=d.useCallback(()=>{i&&i.reInit(o.current,t.current)},[i]);return d.useEffect(()=>{Ns(o.current,s)||(o.current=s,l())},[s,l]),d.useEffect(()=>{Za(t.current,a)||(t.current=a,l())},[a,l]),d.useEffect(()=>{if(Ka()&&r){He.globalOptions=ks.globalOptions;const c=He(r,o.current,t.current);return n(c),()=>c.destroy()}else n(void 0)},[r,n]),[m,i]}ks.globalOptions=void 0;const vr=d.createContext(null);function Ke(){const s=d.useContext(vr);if(!s)throw new Error("useCarousel must be used within a <Carousel />");return s}const kr=d.forwardRef(({orientation:s="horizontal",opts:a,setApi:o,plugins:t,className:i,children:n,...r},m)=>{const[l,c]=ks({...a,axis:s==="horizontal"?"x":"y"},t),[x,u]=d.useState(!1),[h,v]=d.useState(!1),p=d.useCallback(w=>{w&&(u(w.canScrollPrev()),v(w.canScrollNext()))},[]),g=d.useCallback(()=>{c?.scrollPrev()},[c]),N=d.useCallback(()=>{c?.scrollNext()},[c]),b=d.useCallback(w=>{w.key==="ArrowLeft"?(w.preventDefault(),g()):w.key==="ArrowRight"&&(w.preventDefault(),N())},[g,N]);return d.useEffect(()=>{!c||!o||o(c)},[c,o]),d.useEffect(()=>{if(c)return p(c),c.on("reInit",p),c.on("select",p),()=>{c?.off("select",p)}},[c,p]),e.jsxDEV(vr.Provider,{value:{carouselRef:l,api:c,opts:a,orientation:s||(a?.axis==="y"?"vertical":"horizontal"),scrollPrev:g,scrollNext:N,canScrollPrev:x,canScrollNext:h},children:e.jsxDEV("div",{ref:m,onKeyDownCapture:b,className:ve("relative",i),role:"region","aria-roledescription":"carousel",...r,children:n},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:135,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:122,columnNumber:7},void 0)});kr.displayName="Carousel";const Er=d.forwardRef(({className:s,...a},o)=>{const{carouselRef:t,orientation:i}=Ke();return e.jsxDEV("div",{ref:t,className:"overflow-hidden",children:e.jsxDEV("div",{ref:o,className:ve("flex",i==="horizontal"?"-ml-4":"-mt-4 flex-col",s),...a},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:159,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:158,columnNumber:5},void 0)});Er.displayName="CarouselContent";const Dr=d.forwardRef(({className:s,...a},o)=>{const{orientation:t}=Ke();return e.jsxDEV("div",{ref:o,role:"group","aria-roledescription":"slide",className:ve("min-w-0 shrink-0 grow-0 basis-full",t==="horizontal"?"pl-4":"pt-4",s),...a},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:180,columnNumber:5},void 0)});Dr.displayName="CarouselItem";const Vr=d.forwardRef(({className:s,variant:a="outline",size:o="icon",...t},i)=>{const{orientation:n,scrollPrev:r,canScrollPrev:m}=Ke();return e.jsxDEV(_,{ref:i,variant:a,size:o,className:ve("absolute  h-8 w-8 rounded-full",n==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!m,onClick:r,...t,children:[e.jsxDEV(Yr,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:217,columnNumber:7},void 0),e.jsxDEV("span",{className:"sr-only",children:"Previous slide"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:218,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:202,columnNumber:5},void 0)});Vr.displayName="CarouselPrevious";const Ur=d.forwardRef(({className:s,variant:a="outline",size:o="icon",...t},i)=>{const{orientation:n,scrollNext:r,canScrollNext:m}=Ke();return e.jsxDEV(_,{ref:i,variant:a,size:o,className:ve("absolute h-8 w-8 rounded-full",n==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!m,onClick:r,...t,children:[e.jsxDEV(Gr,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:246,columnNumber:7},void 0),e.jsxDEV("span",{className:"sr-only",children:"Next slide"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:247,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/ui/carousel.tsx",lineNumber:231,columnNumber:5},void 0)});Ur.displayName="CarouselNext";const Os=({files:s,onFilesChange:a,maxFiles:o=10,allowedTypes:t=["image/*","video/*"]})=>{const[i,n]=d.useState(!1);d.useState({});const[r,m]=d.useState({}),l=d.useRef(null),c=f=>f.size>50*1024*1024?(y({title:"File too large",description:"Please select files under 50MB",variant:"destructive"}),!1):t.some(E=>f.type.match(E.replace("*",".*")))?!0:(y({title:"Invalid file type",description:"Please select images or videos only",variant:"destructive"}),!1),x=f=>new Promise(D=>{const E=new FileReader;E.onload=()=>D(E.result),E.readAsDataURL(f)}),u=async f=>{const E=Array.from(f).filter(c);if(s.length+E.length>o){y({title:"Too many files",description:`Maximum ${o} files allowed`,variant:"destructive"});return}const k={};for(const V of E){const C=await x(V);k[V.name]=C}m(V=>({...V,...k})),a([...s,...E])},h=f=>{const D=s[f],E=s.filter((k,V)=>V!==f);if(r[D.name]){URL.revokeObjectURL(r[D.name]);const k={...r};delete k[D.name],m(k)}a(E)},v=d.useCallback(f=>{f.preventDefault(),n(!0)},[]),p=d.useCallback(f=>{f.preventDefault(),n(!1)},[]),g=d.useCallback(f=>{f.preventDefault(),n(!1),u(f.dataTransfer.files)},[s,o]),N=()=>{l.current?.click()},b=f=>{if(f===0)return"0 Bytes";const D=1024,E=["Bytes","KB","MB","GB"],k=Math.floor(Math.log(f)/Math.log(D));return parseFloat((f/Math.pow(D,k)).toFixed(2))+" "+E[k]},w=f=>f.type.startsWith("video/")?e.jsxDEV(ge,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:136,columnNumber:14},void 0):e.jsxDEV(Zs,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:138,columnNumber:12},void 0);return e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors cursor-pointer ${i?"border-primary bg-primary/5":"border-gray-300 hover:border-primary/50"}`,onDragOver:v,onDragLeave:p,onDrop:g,onClick:N,children:[e.jsxDEV("input",{ref:l,type:"file",multiple:!0,accept:t.join(","),onChange:f=>f.target.files&&u(f.target.files),className:"hidden"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:155,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxDEV("div",{className:"p-3 bg-primary/10 rounded-full",children:e.jsxDEV(Wr,{className:"h-6 w-6 text-primary"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:166,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:165,columnNumber:11},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("h3",{className:"text-lg font-medium",children:i?"Drop files here":"Upload Media"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:170,columnNumber:13},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Drag & drop or click to select photos and videos"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:173,columnNumber:13},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:["Up to ",o," files, 50MB each"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:176,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:169,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex space-x-2",children:[e.jsxDEV(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsxDEV(as,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:183,columnNumber:15},void 0),"Camera"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:182,columnNumber:13},void 0),e.jsxDEV(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsxDEV(Kr,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:187,columnNumber:15},void 0),"Gallery"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:186,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:181,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:164,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:144,columnNumber:7},void 0),s.length>0&&e.jsxDEV("div",{className:"space-y-3",children:[e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("h4",{className:"text-sm font-medium",children:["Selected Media (",s.length,"/",o,")"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:198,columnNumber:13},void 0),s.length>1&&e.jsxDEV(Ne,{variant:"secondary",className:"gap-1",children:[e.jsxDEV(Zr,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:203,columnNumber:17},void 0),"Carousel"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:202,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:197,columnNumber:11},void 0),s.length===1?e.jsxDEV(ie,{className:"overflow-hidden",children:[e.jsxDEV("div",{className:"relative",children:[r[s[0].name]&&e.jsxDEV("div",{className:"aspect-video bg-black flex items-center justify-center",children:s[0].type.startsWith("video/")?e.jsxDEV("video",{src:r[s[0].name],className:"max-h-full max-w-full",controls:!0},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:216,columnNumber:23},void 0):e.jsxDEV("img",{src:r[s[0].name],alt:"Preview",className:"max-h-full max-w-full object-contain"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:222,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:214,columnNumber:19},void 0),e.jsxDEV("div",{className:"absolute top-2 right-2 flex space-x-2",children:[e.jsxDEV(_,{size:"sm",variant:"secondary",className:"h-8 w-8 p-0",onClick:()=>{},children:e.jsxDEV(os,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:238,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:232,columnNumber:19},void 0),e.jsxDEV(_,{size:"sm",variant:"destructive",className:"h-8 w-8 p-0",onClick:()=>h(0),children:e.jsxDEV(we,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:246,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:240,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:231,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:212,columnNumber:15},void 0),e.jsxDEV(ue,{className:"p-3",children:e.jsxDEV("div",{className:"flex items-center justify-between text-sm",children:[e.jsxDEV("div",{className:"flex items-center space-x-2",children:[w(s[0]),e.jsxDEV("span",{className:"truncate",children:s[0].name},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:255,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:253,columnNumber:19},void 0),e.jsxDEV("span",{className:"text-muted-foreground",children:b(s[0].size)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:257,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:252,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:251,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:211,columnNumber:13},void 0):e.jsxDEV(kr,{className:"w-full",children:[e.jsxDEV(Er,{className:"-ml-2",children:s.map((f,D)=>e.jsxDEV(Dr,{className:"pl-2 basis-1/2 sm:basis-1/3",children:e.jsxDEV(ie,{className:"overflow-hidden",children:e.jsxDEV("div",{className:"relative aspect-square bg-black flex items-center justify-center",children:[r[f.name]&&e.jsxDEV(e.Fragment,{children:f.type.startsWith("video/")?e.jsxDEV("video",{src:r[f.name],className:"w-full h-full object-cover"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:274,columnNumber:31},void 0):e.jsxDEV("img",{src:r[f.name],alt:"Preview",className:"w-full h-full object-cover"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:279,columnNumber:31},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:272,columnNumber:27},void 0),e.jsxDEV("div",{className:"absolute top-1 right-1",children:e.jsxDEV(_,{size:"sm",variant:"destructive",className:"h-6 w-6 p-0",onClick:()=>h(D),children:e.jsxDEV(we,{className:"h-2 w-2"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:295,columnNumber:29},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:289,columnNumber:27},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:288,columnNumber:25},void 0),e.jsxDEV("div",{className:"absolute bottom-1 left-1",children:w(f)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:299,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:270,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:269,columnNumber:21},void 0)},f.name,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:268,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:266,columnNumber:15},void 0),e.jsxDEV(Vr,{},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:307,columnNumber:15},void 0),e.jsxDEV(Ur,{},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:308,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:265,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex space-x-2",children:[e.jsxDEV(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsxDEV(os,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:315,columnNumber:15},void 0),"Edit"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:314,columnNumber:13},void 0),e.jsxDEV(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsxDEV(Qr,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:319,columnNumber:15},void 0),"Crop"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:318,columnNumber:13},void 0),e.jsxDEV(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsxDEV(Ks,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:323,columnNumber:15},void 0),"Filter"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:322,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:313,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:196,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernMediaUpload.tsx",lineNumber:142,columnNumber:5},void 0)},jo=({position:s,onPositionChange:a,isPinPlaced:o,locationName:t,onLocationNameChange:i,isPrivate:n,onPrivacyChange:r})=>{const[m,l]=d.useState(""),[c,x]=d.useState(!1),[u,h]=d.useState([{id:"1",name:"Central Park",category:"Park",distance:"0.2 miles",coordinates:{lat:40.785091,lng:-73.968285}},{id:"2",name:"Times Square",category:"Tourist Attraction",distance:"1.5 miles",coordinates:{lat:40.758896,lng:-73.98513}},{id:"3",name:"Brooklyn Bridge",category:"Landmark",distance:"3.2 miles",coordinates:{lat:40.706086,lng:-73.996864}}]),[v,p]=d.useState(""),[g,N]=d.useState(!1),b=d.useCallback(()=>{if(!navigator.geolocation){y({title:"Geolocation not supported",description:"Your browser doesn't support geolocation",variant:"destructive"});return}navigator.geolocation.getCurrentPosition(k=>{const V={lat:k.coords.latitude,lng:k.coords.longitude};a(V),i("Current Location"),y({title:"Location found",description:"Using your current location"})},k=>{console.error("Geolocation error:",k),y({title:"Location access denied",description:"Please enable location services to use this feature",variant:"destructive"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},[a,i]),w=d.useCallback(async k=>{k.trim()&&(x(!0),setTimeout(()=>{x(!1),k.toLowerCase().includes("coffee")&&h(V=>[{id:"search-1",name:"Starbucks Coffee",category:"Coffee Shop",distance:"0.1 miles",coordinates:{lat:40.7589,lng:-73.9851}},...V.slice(0,2)])},1e3))},[]),f=k=>{a(k.coordinates),i(k.name),y({title:"Location selected",description:`Selected ${k.name}`})},D=()=>{v.trim()&&s&&(i(v),N(!1),p(""),y({title:"Custom location set",description:`Location named "${v}"`}))},E=k=>`${k.lat.toFixed(6)}, ${k.lng.toFixed(6)}`;return e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV(ie,{className:`border-2 ${o?"border-green-200 bg-green-50":"border-orange-200 bg-orange-50"}`,children:e.jsxDEV(ue,{className:"p-4",children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"flex items-center space-x-3",children:[e.jsxDEV("div",{className:`p-2 rounded-full ${o?"bg-green-100":"bg-orange-100"}`,children:e.jsxDEV(he,{className:`h-4 w-4 ${o?"text-green-600":"text-orange-600"}`},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:166,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:165,columnNumber:15},void 0),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"font-medium",children:o?t||"Location Selected":"Select Location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:169,columnNumber:17},void 0),s&&e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:E(s)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:173,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:168,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:164,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2",children:o&&e.jsxDEV(Ne,{variant:"secondary",className:"gap-1",children:n?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Qs,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:185,columnNumber:23},void 0),"Private"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:184,columnNumber:21},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Xs,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:190,columnNumber:23},void 0),"Public"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:189,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:182,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:180,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:163,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:162,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:161,columnNumber:7},void 0),e.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxDEV(_,{variant:"outline",className:"gap-2",onClick:b,children:[e.jsxDEV(bs,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:208,columnNumber:11},void 0),"Use Current"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:203,columnNumber:9},void 0),e.jsxDEV(_,{variant:"outline",className:"gap-2",onClick:()=>y({title:"Map selector",description:"Click on the map to place a pin"}),children:[e.jsxDEV(Xr,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:216,columnNumber:11},void 0),"Place Pin"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:211,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:202,columnNumber:7},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(de,{htmlFor:"location-search",children:"Search Places"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:223,columnNumber:9},void 0),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(Ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:225,columnNumber:11},void 0),e.jsxDEV(Me,{id:"location-search",placeholder:"Search for restaurants, parks, landmarks...",value:m,onChange:k=>l(k.target.value),onKeyPress:k=>k.key==="Enter"&&w(m),className:"pl-10"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:226,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:224,columnNumber:9},void 0),c&&e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Searching..."},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:236,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:222,columnNumber:7},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(de,{children:"Suggested Locations"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:242,columnNumber:9},void 0),e.jsxDEV("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:u.map(k=>e.jsxDEV(ie,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>f(k),children:e.jsxDEV(ue,{className:"p-3",children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"flex items-center space-x-3",children:[e.jsxDEV("div",{className:"p-1 bg-primary/10 rounded",children:e.jsxDEV(he,{className:"h-3 w-3 text-primary"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:254,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:253,columnNumber:21},void 0),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"font-medium text-sm",children:k.name},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:257,columnNumber:23},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:[k.category," ‚Ä¢ ",k.distance]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:258,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:256,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:252,columnNumber:19},void 0),e.jsxDEV(_,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",children:e.jsxDEV(he,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:264,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:263,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:251,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:250,columnNumber:15},void 0)},k.id,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:245,columnNumber:13},void 0))},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:243,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:241,columnNumber:7},void 0),o&&e.jsxDEV("div",{className:"space-y-3",children:g?e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(de,{htmlFor:"custom-location",children:"Custom Location Name"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:296,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex space-x-2",children:[e.jsxDEV(Me,{id:"custom-location",placeholder:"Enter custom location name...",value:v,onChange:k=>p(k.target.value),onKeyPress:k=>k.key==="Enter"&&D()},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:298,columnNumber:17},void 0),e.jsxDEV(_,{size:"sm",onClick:D,disabled:!v.trim(),children:"Save"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:305,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:297,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:295,columnNumber:13},void 0):e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV(de,{children:"Location Name"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:279,columnNumber:17},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:t||"Unnamed Location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:280,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:278,columnNumber:15},void 0),e.jsxDEV(_,{size:"sm",variant:"outline",onClick:()=>N(!0),className:"gap-2",children:[e.jsxDEV(os,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:290,columnNumber:17},void 0),"Edit"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:284,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:277,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:275,columnNumber:9},void 0),o&&e.jsxDEV("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxDEV("div",{className:"flex items-center space-x-3",children:[n?e.jsxDEV(Jr,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:323,columnNumber:15},void 0):e.jsxDEV(Ge,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:325,columnNumber:15},void 0),e.jsxDEV("div",{children:[e.jsxDEV(de,{htmlFor:"location-privacy",children:"Hide precise location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:328,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:n?"Others will see general area only":"Others will see exact location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:329,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:327,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:321,columnNumber:11},void 0),e.jsxDEV(gs,{id:"location-privacy",checked:n,onCheckedChange:r},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:337,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:320,columnNumber:9},void 0),s&&e.jsxDEV(ie,{children:[e.jsxDEV(ps,{className:"pb-3",children:e.jsxDEV(hs,{className:"text-sm flex items-center gap-2",children:[e.jsxDEV(ea,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:350,columnNumber:15},void 0),"Location Preview"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:349,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:348,columnNumber:11},void 0),e.jsxDEV(ue,{className:"p-0",children:e.jsxDEV("div",{className:"h-32 bg-muted flex items-center justify-center",children:e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:["Map preview for ",E(s)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:356,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:355,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:354,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:347,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/ModernLocationSelector.tsx",lineNumber:159,columnNumber:5},void 0)},So=({onStreamStart:s,onStreamEnd:a,isStreaming:o})=>{const[t,i]=d.useState(""),[n,r]=d.useState(""),[m,l]=d.useState("720p"),[c,x]=d.useState(!0),[u,h]=d.useState(!0),[v,p]=d.useState(0),[g,N]=d.useState(0),[b,w]=d.useState("disconnected"),[f,D]=d.useState(0),E=d.useRef(null),k=d.useRef(null),V=d.useRef(null);d.useEffect(()=>()=>{k.current&&k.current.getTracks().forEach(F=>F.stop()),V.current&&clearInterval(V.current)},[]);const C=async()=>{if(!t.trim()){y({title:"Stream title required",description:"Please enter a title for your live stream",variant:"destructive"});return}try{w("connecting");const F=await navigator.mediaDevices.getUserMedia({video:{width:m==="1080p"?1920:m==="720p"?1280:640,height:m==="1080p"?1080:m==="720p"?720:480,frameRate:30},audio:c});k.current=F,E.current&&(E.current.srcObject=F,E.current.play()),N(0),V.current=setInterval(()=>{N(T=>T+1)},1e3);const L=setInterval(()=>{p(T=>Math.max(0,T+Math.floor(Math.random()*3)-1))},5e3);return w("connected"),D(Math.floor(Math.random()*1e3)+500),s({title:t,description:n,quality:m,stream:F}),y({title:"Live stream started!",description:"You're now broadcasting live"}),()=>clearInterval(L)}catch(F){console.error("Stream start error:",F),w("disconnected"),y({title:"Failed to start stream",description:"Please check camera and microphone permissions",variant:"destructive"})}},U=()=>{k.current&&(k.current.getTracks().forEach(F=>F.stop()),k.current=null),E.current&&(E.current.srcObject=null),V.current&&(clearInterval(V.current),V.current=null),w("disconnected"),D(0),a(),y({title:"Stream ended",description:`Your live stream lasted ${O(g)}`})},$=async()=>{k.current&&(k.current.getAudioTracks().forEach(L=>{L.enabled=!c}),x(!c))},P=async()=>{k.current&&(k.current.getVideoTracks().forEach(L=>{L.enabled=!u}),h(!u))},O=F=>{const L=Math.floor(F/3600),T=Math.floor(F%3600/60),Y=F%60;return L>0?`${L}:${T.toString().padStart(2,"0")}:${Y.toString().padStart(2,"0")}`:`${T}:${Y.toString().padStart(2,"0")}`},R=()=>{switch(b){case"connected":return e.jsxDEV(ra,{className:"h-4 w-4 text-green-500"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:179,columnNumber:32},void 0);case"connecting":return e.jsxDEV(Is,{className:"h-4 w-4 text-yellow-500 animate-pulse"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:180,columnNumber:33},void 0);default:return e.jsxDEV(sa,{className:"h-4 w-4 text-red-500"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:181,columnNumber:23},void 0)}},W=()=>{switch(b){case"connected":return"bg-green-500";case"connecting":return"bg-yellow-500";default:return"bg-gray-500"}};return o?e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV(ie,{className:"border-red-200 bg-red-50",children:e.jsxDEV(ue,{className:"p-4",children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"flex items-center space-x-3",children:[e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV("div",{className:`w-3 h-3 rounded-full animate-pulse ${W()}`},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:325,columnNumber:17},void 0),e.jsxDEV("span",{className:"text-red-600 font-semibold",children:"LIVE"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:326,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:324,columnNumber:15},void 0),e.jsxDEV("div",{className:"text-sm text-red-600",children:O(g)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:328,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:323,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxDEV("div",{className:"flex items-center space-x-1",children:[e.jsxDEV(Ce,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:335,columnNumber:17},void 0),e.jsxDEV("span",{children:v},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:336,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:334,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex items-center space-x-1",children:[R(),e.jsxDEV("span",{children:[f," kbps"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:340,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:338,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:333,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:322,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:321,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:320,columnNumber:7},void 0),e.jsxDEV(ie,{children:e.jsxDEV(ue,{className:"p-0",children:e.jsxDEV("div",{className:"relative aspect-video bg-black rounded-md overflow-hidden",children:[e.jsxDEV("video",{ref:E,className:"w-full h-full object-cover",autoPlay:!0,muted:!0,playsInline:!0},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:351,columnNumber:13},void 0),e.jsxDEV("div",{className:"absolute bottom-4 left-4 right-4",children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"flex space-x-2",children:[e.jsxDEV(_,{size:"sm",variant:c?"secondary":"destructive",onClick:$,className:"h-10 w-10 p-0",children:c?e.jsxDEV(ze,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:369,columnNumber:39},void 0):e.jsxDEV(ts,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:369,columnNumber:69},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:363,columnNumber:19},void 0),e.jsxDEV(_,{size:"sm",variant:u?"secondary":"destructive",onClick:P,className:"h-10 w-10 p-0",children:u?e.jsxDEV(ge,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:378,columnNumber:39},void 0):e.jsxDEV(qe,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:378,columnNumber:71},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:372,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:362,columnNumber:17},void 0),e.jsxDEV(_,{size:"sm",variant:"destructive",onClick:U,className:"gap-2",children:[e.jsxDEV(er,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:388,columnNumber:19},void 0),"End Stream"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:382,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:361,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:360,columnNumber:13},void 0),e.jsxDEV("div",{className:"absolute top-4 left-4 right-4",children:e.jsxDEV("div",{className:"bg-black/50 backdrop-blur-sm rounded-lg p-3 text-white",children:[e.jsxDEV("h3",{className:"font-semibold truncate",children:t},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:397,columnNumber:17},void 0),n&&e.jsxDEV("p",{className:"text-sm opacity-90 truncate",children:n},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:399,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:396,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:395,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:350,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:349,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:348,columnNumber:7},void 0),e.jsxDEV(ie,{children:e.jsxDEV(ue,{className:"p-4",children:e.jsxDEV("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"flex items-center justify-center space-x-1 text-2xl font-bold",children:[e.jsxDEV(Ce,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:413,columnNumber:17},void 0),v]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:412,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Viewers"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:416,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:411,columnNumber:13},void 0),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"flex items-center justify-center space-x-1 text-2xl font-bold",children:[e.jsxDEV(Ve,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:421,columnNumber:17},void 0),O(g)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:420,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Duration"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:424,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:419,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:410,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:409,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:408,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:318,columnNumber:5},void 0):e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV(ie,{children:[e.jsxDEV(ps,{children:e.jsxDEV(hs,{className:"text-lg flex items-center gap-2",children:[e.jsxDEV(Be,{className:"h-5 w-5 text-red-500"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:200,columnNumber:15},void 0),"Go Live"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:199,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:198,columnNumber:11},void 0),e.jsxDEV(ue,{className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(de,{htmlFor:"stream-title",children:"Stream Title *"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:206,columnNumber:15},void 0),e.jsxDEV(Me,{id:"stream-title",placeholder:"What's happening?",value:t,onChange:F=>i(F.target.value),maxLength:100},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:207,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:[t.length,"/100 characters"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:214,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:205,columnNumber:13},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(de,{htmlFor:"stream-description",children:"Description (Optional)"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:220,columnNumber:15},void 0),e.jsxDEV(Me,{id:"stream-description",placeholder:"Tell viewers what to expect...",value:n,onChange:F=>r(F.target.value),maxLength:200},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:221,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:219,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(de,{htmlFor:"stream-quality",children:"Quality"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:232,columnNumber:17},void 0),e.jsxDEV(Va,{value:m,onValueChange:l,children:[e.jsxDEV(Ua,{children:e.jsxDEV(ya,{},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:235,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:234,columnNumber:19},void 0),e.jsxDEV(ja,{children:[e.jsxDEV(ss,{value:"480p",children:"480p (Standard)"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:238,columnNumber:21},void 0),e.jsxDEV(ss,{value:"720p",children:"720p (HD)"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:239,columnNumber:21},void 0),e.jsxDEV(ss,{value:"1080p",children:"1080p (Full HD)"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:240,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:233,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:231,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(de,{children:"Camera Preview"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:246,columnNumber:17},void 0),e.jsxDEV("div",{className:"aspect-video bg-black rounded-md flex items-center justify-center",children:e.jsxDEV("video",{ref:E,className:"w-full h-full object-cover rounded-md",autoPlay:!0,muted:!0,playsInline:!0},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:248,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:247,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:245,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:230,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex justify-center",children:e.jsxDEV(_,{onClick:C,className:"bg-red-500 hover:bg-red-600 text-white px-8",disabled:b==="connecting",children:b==="connecting"?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Is,{className:"h-4 w-4 mr-2 animate-pulse"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:267,columnNumber:21},void 0),"Connecting..."]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:266,columnNumber:19},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Be,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:272,columnNumber:21},void 0),"Start Live Stream"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:271,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:260,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:259,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:204,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:197,columnNumber:9},void 0),e.jsxDEV(ie,{children:e.jsxDEV(ue,{className:"p-4",children:e.jsxDEV("div",{className:"flex items-center justify-around",children:[e.jsxDEV(_,{variant:c?"default":"outline",size:"sm",onClick:()=>x(!c),className:"gap-2",children:[c?e.jsxDEV(ze,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:291,columnNumber:35},void 0):e.jsxDEV(ts,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:291,columnNumber:65},void 0),"Audio"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:285,columnNumber:15},void 0),e.jsxDEV(_,{variant:u?"default":"outline",size:"sm",onClick:()=>h(!u),className:"gap-2",children:[u?e.jsxDEV(ge,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:301,columnNumber:35},void 0):e.jsxDEV(qe,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:301,columnNumber:67},void 0),"Video"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:295,columnNumber:15},void 0),e.jsxDEV(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsxDEV(Js,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:306,columnNumber:17},void 0),"Settings"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:305,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:284,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:283,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:282,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/LiveStreamInterface.tsx",lineNumber:195,columnNumber:7},void 0)},rs=({content:s,onContentChange:a,placeholder:o="What's happening here?",maxLength:t=500,onHashtagsChange:i,onMentionsChange:n,showFormatting:r=!0})=>{const[m,l]=d.useState(!1),[c,x]=d.useState(!1),[u,h]=d.useState([]),[v,p]=d.useState(!1),[g,N]=d.useState(0),b=d.useRef(null),w=["üòÄ","üòÇ","‚ù§Ô∏è","üëç","üî•","üéâ","üòç","ü§î","üòé","üíØ","üìç","üåü","‚ú®","üôå"],f=["#photography","#travel","#food","#nature","#sunset","#citylife","#weekend"],D=["@john_doe","@jane_smith","@local_explorer","@foodie_friend"],E=L=>{const T=/#[a-zA-Z0-9_]+/g;return L.match(T)||[]},k=L=>{const T=/@[a-zA-Z0-9_]+/g;return L.match(T)||[]},V=L=>{const T=L.target.value;if(T.length<=t){a(T);const Y=E(T),Q=k(T);i?.(Y),n?.(Q);const re=L.target.selectionStart;N(re);const ee=T.substring(0,re).split(/\s/).pop()||"";if(ee.startsWith("#")){const K=ee.substring(1).toLowerCase(),M=f.filter(B=>B.toLowerCase().includes(K));h(M),p(M.length>0)}else if(ee.startsWith("@")){const K=ee.substring(1).toLowerCase(),M=D.filter(B=>B.toLowerCase().includes(K));h(M),p(M.length>0)}else p(!1)}else y({title:"Character limit reached",description:`Maximum ${t} characters allowed`,variant:"destructive"})},C=L=>{if(b.current){const T=b.current,Y=T.selectionStart,Q=T.selectionEnd,re=s.substring(0,Y)+L+s.substring(Q);a(re),setTimeout(()=>{if(b.current){const H=Y+L.length;b.current.setSelectionRange(H,H),b.current.focus()}},0)}},U=L=>{C(L+" "),x(!1)},$=L=>{if(b.current){b.current;const T=s.substring(0,g),Y=s.substring(g),Q=T.lastIndexOf(" "),re=Q===-1?0:Q+1,H=s.substring(0,re)+L+" "+Y;a(H),p(!1),setTimeout(()=>{if(b.current){const ee=re+L.length+1;b.current.setSelectionRange(ee,ee),b.current.focus()}},0)}},P=()=>{s.trim()&&(localStorage.setItem("message_draft",s),l(!0),y({title:"Draft saved",description:"Your message has been saved as a draft"}))},O=()=>{const L=localStorage.getItem("message_draft");L&&(a(L),y({title:"Draft loaded",description:"Your saved draft has been loaded"}))},R=()=>{localStorage.removeItem("message_draft"),l(!1),y({title:"Draft cleared",description:"Saved draft has been removed"})};d.useEffect(()=>{localStorage.getItem("message_draft")&&!s&&l(!0)},[]);const W=s.length,F=W>t*.8;return e.jsxDEV("div",{className:"space-y-3",children:[m&&e.jsxDEV("div",{className:"flex items-center justify-between p-2 bg-blue-50 rounded-md",children:[e.jsxDEV("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsxDEV(ns,{className:"h-4 w-4 text-blue-600"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:208,columnNumber:13},void 0),e.jsxDEV("span",{className:"text-blue-600",children:"Draft available"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:209,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:207,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex space-x-2",children:[e.jsxDEV(_,{size:"sm",variant:"outline",onClick:O,children:"Load Draft"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:212,columnNumber:13},void 0),e.jsxDEV(_,{size:"sm",variant:"ghost",onClick:R,children:e.jsxDEV(sr,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:216,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:211,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:206,columnNumber:9},void 0),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(Sa,{ref:b,value:s,onChange:V,placeholder:o,className:"min-h-[120px] resize-none pr-16 text-base leading-relaxed",rows:6},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:224,columnNumber:9},void 0),e.jsxDEV("div",{className:"absolute bottom-3 right-3",children:e.jsxDEV(Ne,{variant:F?"destructive":"secondary",className:"text-xs",children:[W,"/",t]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:235,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:234,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:223,columnNumber:7},void 0),v&&u.length>0&&e.jsxDEV(ie,{className:"absolute z-10 w-full max-w-xs",children:e.jsxDEV(ue,{className:"p-2",children:e.jsxDEV("div",{className:"space-y-1",children:u.map((L,T)=>e.jsxDEV(_,{variant:"ghost",size:"sm",className:"w-full justify-start text-sm",onClick:()=>$(L),children:L},T,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:250,columnNumber:17},void 0))},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:248,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:247,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:246,columnNumber:9},void 0),r&&e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(_,{size:"sm",variant:"outline",onClick:()=>C("#"),className:"h-8 px-2",children:e.jsxDEV(Ts,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:276,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:270,columnNumber:13},void 0),e.jsxDEV(_,{size:"sm",variant:"outline",onClick:()=>C("@"),className:"h-8 px-2",children:e.jsxDEV(As,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:285,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:279,columnNumber:13},void 0),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(_,{size:"sm",variant:"outline",onClick:()=>x(!c),className:"h-8 px-2",children:e.jsxDEV(aa,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:296,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:290,columnNumber:15},void 0),c&&e.jsxDEV(ie,{className:"absolute bottom-10 left-0 z-10 p-2",children:e.jsxDEV("div",{className:"grid grid-cols-7 gap-1",children:w.map((L,T)=>e.jsxDEV(_,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-lg hover:bg-muted",onClick:()=>U(L),children:L},T,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:303,columnNumber:23},void 0))},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:301,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:300,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:289,columnNumber:13},void 0),e.jsxDEV(_,{size:"sm",variant:"outline",onClick:P,className:"h-8 px-2",disabled:!s.trim(),children:e.jsxDEV(ns,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:326,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:319,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:268,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex items-center space-x-3 text-xs text-muted-foreground",children:[E(s).length>0&&e.jsxDEV("div",{className:"flex items-center space-x-1",children:[e.jsxDEV(Ts,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:334,columnNumber:17},void 0),e.jsxDEV("span",{children:E(s).length},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:335,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:333,columnNumber:15},void 0),k(s).length>0&&e.jsxDEV("div",{className:"flex items-center space-x-1",children:[e.jsxDEV(As,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:341,columnNumber:17},void 0),e.jsxDEV("span",{children:k(s).length},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:342,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:340,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex items-center space-x-1",children:[e.jsxDEV(ds,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:347,columnNumber:15},void 0),e.jsxDEV("span",{children:[s.split(/\s+/).filter(L=>L.length>0).length," words"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:348,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:346,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:331,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:267,columnNumber:9},void 0),(E(s).length>0||k(s).length>0)&&e.jsxDEV("div",{className:"flex flex-wrap gap-1",children:[E(s).map((L,T)=>e.jsxDEV(Ne,{variant:"secondary",className:"text-xs",children:L},`hashtag-${T}`,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:358,columnNumber:13},void 0)),k(s).map((L,T)=>e.jsxDEV(Ne,{variant:"outline",className:"text-xs",children:L},`mention-${T}`,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:363,columnNumber:13},void 0))]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:356,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/RichTextEditor.tsx",lineNumber:203,columnNumber:5},void 0)},Mo=({onClose:s,initialPosition:a,addMessage:o,updateMessage:t})=>{const{user:i}=Ae(),[n,r]=d.useState(""),[m,l]=d.useState(!0),[c,x]=d.useState(null),[u,h]=d.useState(null),[v,p]=d.useState(!1),[g,N]=d.useState(a),[b,w]=d.useState(!1),[f,D]=d.useState("text"),[E,k]=d.useState([]),[V,C]=d.useState(""),[U,$]=d.useState([]),[P,O]=d.useState([]),[R,W]=d.useState(!1),[F,L]=d.useState(0),[T,Y]=d.useState(!1);d.useEffect(()=>{a&&(N(a),w(!0))},[a]);const Q=()=>{if(n.trim()){const K={content:n,activeTab:f,mediaFiles:E,locationName:V,hashtags:U,mentions:P,isPublic:m,position:g,timestamp:Date.now()};localStorage.setItem("lo_draft",JSON.stringify(K)),W(!0),y({title:"Draft saved",description:"Your Lo has been saved as a draft"})}},re=()=>{localStorage.removeItem("lo_draft"),W(!1)};d.useEffect(()=>{localStorage.getItem("lo_draft")&&!n&&W(!0)},[n]),d.useEffect(()=>{L(n.length)},[n]);const H=async K=>{if(K.preventDefault(),!g||!b){y({title:"Location required",description:"Please place and confirm the pin location for your Lo",variant:"destructive"});return}if(!i){y({title:"Authentication required",description:"Please sign in to post a Lo",variant:"destructive"});return}p(!0);try{const M=u;let B="text";E.length>0?B=E[0].type.startsWith("video/")?"video":"image":c&&(B=c.type.startsWith("video/")?"video":"image"),f==="live"&&(B="livestream");const{data:I,error:j}=await G.from("messages").insert({content:n,location:V||"Current Location",user_id:i.id,is_public:m,lat:g.lat,lng:g.lng,media_url:M||null,expires_at:new Date(Date.now()+24*60*60*1e3).toISOString()}).select("*, profiles:user_id(name, username, avatar_url)").single();if(j)throw console.error("‚ùå Database error:",j),j;const z=I.lat??g.lat,X=I.lng??g.lng,ae={id:`new-${I.id}`,content:I.content??"",location:I.location??"Current Location",user:{name:I.profiles?.name||i.user_metadata?.full_name||"Current User",avatar:I.profiles?.avatar_url||i.user_metadata?.avatar_url||"/placeholder.svg"},isPublic:!!I.is_public,timestamp:I.created_at,expiresAt:I.expires_at??null,mediaUrl:I.media_url??null,position:{lat:z,lng:X,x:z,y:X},lat:z,lng:X,liked:!1,likes:0,isEvent:!1};o(ae),pe.emit("messageCreated",{id:I.id}),re(),setTimeout(()=>{t(ae.id,{id:I.id})},2e3),setTimeout(()=>{pe.emit("refreshMessages",void 0)},100),y({title:"Lo posted!",description:B==="livestream"?"Your live stream Lo is now active!":E.length>1?`Your Lo with ${E.length} media files has been posted!`:B==="video"?"Your video Lo has been posted!":B==="image"?"Your photo Lo has been posted!":"Your Lo is live on the map!"}),s()}catch(M){console.error("Error posting message:",M),y({title:"Error posting Lo",description:M instanceof Error?M.message:"Failed to post your Lo. Please try again.",variant:"destructive"})}finally{p(!1)}},ee=v||!n.trim()||!b;return e.jsxDEV(ie,{className:"w-full max-w-2xl mx-auto bg-white fade-in",children:e.jsxDEV("form",{onSubmit:H,children:[e.jsxDEV(ps,{className:"pb-3",children:e.jsxDEV(hs,{className:"text-xl flex justify-between items-center",children:[e.jsxDEV("span",{children:"Create Lo"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:290,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2",children:[R&&e.jsxDEV(Ne,{variant:"secondary",className:"gap-1",children:[e.jsxDEV(Ve,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:294,columnNumber:19},void 0),"Draft"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:293,columnNumber:17},void 0),e.jsxDEV(_,{type:"button",variant:"ghost",size:"icon",onClick:s,children:e.jsxDEV(we,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:304,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:298,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:291,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:289,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:288,columnNumber:9},void 0),e.jsxDEV(ue,{className:"space-y-4",children:[e.jsxDEV(ga,{value:f,onValueChange:D,className:"w-full",children:[e.jsxDEV(Na,{className:"grid w-full grid-cols-4",children:[e.jsxDEV(Re,{value:"text",className:"gap-2",children:[e.jsxDEV(ds,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:314,columnNumber:17},void 0),"Text"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:313,columnNumber:15},void 0),e.jsxDEV(Re,{value:"photo",className:"gap-2",children:[e.jsxDEV(Zs,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:318,columnNumber:17},void 0),"Photo"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:317,columnNumber:15},void 0),e.jsxDEV(Re,{value:"video",className:"gap-2",children:[e.jsxDEV(ge,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:322,columnNumber:17},void 0),"Video"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:321,columnNumber:15},void 0),e.jsxDEV(Re,{value:"live",className:"gap-2",children:[e.jsxDEV(Be,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:326,columnNumber:17},void 0),"Live"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:325,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:312,columnNumber:13},void 0),e.jsxDEV(Fe,{value:"text",className:"space-y-4 mt-4",children:e.jsxDEV(rs,{content:n,onContentChange:r,onHashtagsChange:$,onMentionsChange:O,placeholder:"What's happening here?",maxLength:500},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:332,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:331,columnNumber:13},void 0),e.jsxDEV(Fe,{value:"photo",className:"space-y-4 mt-4",children:e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV(rs,{content:n,onContentChange:r,onHashtagsChange:$,onMentionsChange:O,placeholder:"Add a caption to your photo...",maxLength:300,showFormatting:!1},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:344,columnNumber:17},void 0),e.jsxDEV(Os,{files:E,onFilesChange:k,maxFiles:10,allowedTypes:["image/*"]},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:353,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:343,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:342,columnNumber:13},void 0),e.jsxDEV(Fe,{value:"video",className:"space-y-4 mt-4",children:e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV(rs,{content:n,onContentChange:r,onHashtagsChange:$,onMentionsChange:O,placeholder:"Describe your video...",maxLength:300,showFormatting:!1},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:364,columnNumber:17},void 0),e.jsxDEV(Os,{files:E,onFilesChange:k,maxFiles:5,allowedTypes:["video/*"]},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:373,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:363,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:362,columnNumber:13},void 0),e.jsxDEV(Fe,{value:"live",className:"space-y-4 mt-4",children:e.jsxDEV(So,{onStreamStart:K=>{console.log("Stream started:",K)},onStreamEnd:()=>{console.log("Stream ended")},isStreaming:!1},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:383,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:382,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:311,columnNumber:11},void 0),e.jsxDEV("div",{className:"border-t pt-4",children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-3",children:[e.jsxDEV("h3",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsxDEV(he,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:401,columnNumber:17},void 0),"Location"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:400,columnNumber:15},void 0),e.jsxDEV(_,{type:"button",variant:"ghost",size:"sm",onClick:()=>Y(!T),children:e.jsxDEV(Js,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:410,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:404,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:399,columnNumber:13},void 0),T?e.jsxDEV(jo,{position:g,onPositionChange:N,isPinPlaced:b,locationName:V,onLocationNameChange:C,isPrivate:!m,onPrivacyChange:K=>l(!K)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:415,columnNumber:15},void 0):e.jsxDEV(Ga,{isPinPlaced:b},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:425,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:398,columnNumber:11},void 0),!T&&e.jsxDEV(Ya,{isPublic:m,onToggle:l},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:431,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:310,columnNumber:9},void 0),e.jsxDEV(fa,{className:"flex justify-between",children:[e.jsxDEV("div",{className:"flex space-x-2",children:e.jsxDEV(_,{type:"button",variant:"outline",onClick:Q,disabled:!n.trim(),className:"gap-2",children:[e.jsxDEV(ns,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:444,columnNumber:15},void 0),"Save Draft"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:437,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:436,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex space-x-2",children:[e.jsxDEV(_,{type:"button",variant:"outline",onClick:s,children:"Cancel"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:450,columnNumber:13},void 0),e.jsxDEV(_,{type:"submit",className:`transition-opacity ${!n.trim()||!b?"opacity-50":"opacity-100"}`,disabled:ee,children:v?e.jsxDEV("span",{className:"flex items-center justify-center",children:[e.jsxDEV(oa,{className:"h-4 w-4 mr-2 animate-spin"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:464,columnNumber:19},void 0),"Posting..."]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:463,columnNumber:17},void 0):"Post Lo"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:457,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:449,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:435,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:287,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageForm.tsx",lineNumber:286,columnNumber:5},void 0)},Co=({onClose:s,initialPosition:a,addMessage:o,updateMessage:t})=>e.jsxDEV("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxDEV(Mo,{onClose:s,initialPosition:a,addMessage:o,updateMessage:t},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageModal.tsx",lineNumber:21,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/message/CreateMessageModal.tsx",lineNumber:20,columnNumber:5},void 0),Lo=({isCreating:s,isInStreetView:a,isPlacingPin:o,newPinPosition:t,userAvatar:i,userName:n,handleClose:r,handleCreateMessage:m,addMessage:l,updateMessage:c})=>e.jsxDEV(e.Fragment,{children:[o&&!a&&e.jsxDEV(Ra,{isPlacingPin:o},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/MessageCreationController.tsx",lineNumber:37,columnNumber:9},void 0),o&&t&&e.jsxDEV(br,{messages:[{id:"new-pin",position:{lat:t.lat,lng:t.lng,x:t.lat,y:t.lng},isPublic:!0,user:{avatar:i,name:n||"New"}}],onMessageClick:()=>{}},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/MessageCreationController.tsx",lineNumber:41,columnNumber:9},void 0),s&&t&&e.jsxDEV(Co,{onClose:r,initialPosition:t,addMessage:l,updateMessage:c},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/MessageCreationController.tsx",lineNumber:63,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/MessageCreationController.tsx",lineNumber:35,columnNumber:5},void 0),Io=({selectedMessage:s,filteredMessages:a,onMessageClick:o,onClose:t})=>e.jsxDEV(e.Fragment,{children:[e.jsxDEV(br,{messages:a,onMessageClick:o},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/MessageDisplayController.tsx",lineNumber:22,columnNumber:7},void 0),s&&(()=>{const i=a.find(n=>n.id===s);return i?e.jsxDEV(ha,{message:i,onClose:t},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/MessageDisplayController.tsx",lineNumber:30,columnNumber:11},void 0):null})()]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/MessageDisplayController.tsx",lineNumber:21,columnNumber:5},void 0),Es=()=>{const[s,a]=d.useState([]),[o,t]=d.useState(!0),{toast:i}=_r(),{user:n}=Ae(),r=d.useRef(null);d.useEffect(()=>(m(),l(),()=>{r.current&&G.removeChannel(r.current)}),[]);const m=async()=>{try{t(!0);const{data:p,error:g}=await G.from("live_streams").select("*").eq("is_live",!0).order("created_at",{ascending:!1});if(g)throw g;const N=[...new Set(p?.map(D=>D.user_id)||[])],{data:b,error:w}=await G.from("profiles").select("id, name, username, avatar_url").in("id",N);if(w)throw w;const f=p?.map(D=>({...D,profiles:b?.find(E=>E.id===D.user_id)}))||[];a(f)}catch(p){console.error("Error fetching live streams:",p),i({title:"Error",description:"Failed to load live streams",variant:"destructive"})}finally{t(!1)}},l=()=>{r.current=G.channel("live-streams-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"live_streams"},p=>{console.log("New live stream:",p),m()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"live_streams"},p=>{console.log("Live stream updated:",p),a(g=>g.map(N=>N.id===p.new.id?{...N,...p.new}:N))}).on("postgres_changes",{event:"DELETE",schema:"public",table:"live_streams"},p=>{console.log("Live stream deleted:",p),a(g=>g.filter(N=>N.id!==p.old.id))}).subscribe()};return{liveStreams:s,isLoading:o,startLiveStream:async p=>{if(!n)return null;try{const{data:g,error:N}=await G.from("live_streams").insert({user_id:n.id,title:p.title||null,description:p.description||null,start_lat:p.lat,start_lng:p.lng,current_lat:p.lat,current_lng:p.lng}).select().single();if(N)throw N;return i({title:"Success",description:"Live stream started!"}),g.id}catch(g){return console.error("Error starting live stream:",g),i({title:"Error",description:"Failed to start live stream",variant:"destructive"}),null}},updateStreamLocation:async(p,g,N)=>{try{const{error:b}=await G.rpc("update_live_stream_location",{stream_id_param:p,new_lat:g,new_lng:N});if(b)throw b}catch(b){console.error("Error updating stream location:",b)}},endLiveStream:async p=>{try{const{error:g}=await G.rpc("end_live_stream",{stream_id_param:p});if(g)throw g;return i({title:"Success",description:"Live stream ended!"}),!0}catch(g){return console.error("Error ending live stream:",g),i({title:"Error",description:"Failed to end live stream",variant:"destructive"}),!1}},joinStreamAsViewer:async p=>{if(!n)return!1;try{const{error:g}=await G.from("live_stream_viewers").upsert({stream_id:p,viewer_id:n.id,is_active:!0});if(g)throw g;return!0}catch(g){return console.error("Error joining stream:",g),!1}},leaveStreamAsViewer:async p=>{if(!n)return!1;try{const{error:g}=await G.from("live_stream_viewers").update({is_active:!1,left_at:new Date().toISOString()}).eq("stream_id",p).eq("viewer_id",n.id);if(g)throw g;return!0}catch(g){return console.error("Error leaving stream:",g),!1}},fetchLiveStreams:m}},To=({liveStreams:s,onStreamSelect:a,selectedStreamId:o,setSelectedStreamId:t})=>{const{joinStreamAsViewer:i}=Es(),n=l=>{t(l.id)},r=async l=>{await i(l.id),a(l),t(null)},m=(l,c)=>{const x=document.createElement("canvas"),u=x.getContext("2d"),h=60;if(x.width=h,x.height=h,u){const v=u.createRadialGradient(h/2,h/2,10,h/2,h/2,h/2);v.addColorStop(0,"rgba(59, 130, 246, 0.8)"),v.addColorStop(1,"rgba(59, 130, 246, 0.2)"),u.fillStyle=v,u.beginPath(),u.arc(h/2,h/2,h/2,0,2*Math.PI),u.fill(),u.fillStyle="rgb(59, 130, 246)",u.beginPath(),u.arc(h/2,h/2,20,0,2*Math.PI),u.fill(),u.strokeStyle="white",u.lineWidth=3,u.stroke(),u.fillStyle="red",u.beginPath(),u.arc(h-8,8,6,0,2*Math.PI),u.fill(),u.strokeStyle="white",u.lineWidth=2,u.stroke()}return{url:x.toDataURL(),scaledSize:new google.maps.Size(h,h),anchor:new google.maps.Point(h/2,h/2)}};return e.jsxDEV(e.Fragment,{children:s.map(l=>e.jsxDEV(xe.Fragment,{children:[e.jsxDEV(cs,{position:{lat:l.current_lat,lng:l.current_lng},icon:m(l.profiles?.avatar_url||void 0,l.profiles?.name||l.profiles?.username||void 0),onClick:()=>n(l),animation:google.maps.Animation.BOUNCE},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:88,columnNumber:11},void 0),o===l.id&&e.jsxDEV($r,{position:{lat:l.current_lat,lng:l.current_lng},onCloseClick:()=>t(null),children:e.jsxDEV("div",{className:"p-3 max-w-xs",children:[e.jsxDEV("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxDEV(tr,{className:"h-12 w-12 ring-2 ring-red-500",children:[e.jsxDEV(nr,{src:l.profiles?.avatar_url||void 0},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:112,columnNumber:21},void 0),e.jsxDEV(ir,{children:l.profiles?.name?.charAt(0)||l.profiles?.username?.charAt(0)||"U"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:113,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:111,columnNumber:19},void 0),e.jsxDEV("div",{className:"flex-1 min-w-0",children:[e.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxDEV("h3",{className:"font-semibold text-sm truncate",children:l.profiles?.name||l.profiles?.username||"Anonymous"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:121,columnNumber:23},void 0),e.jsxDEV(Ne,{variant:"destructive",className:"text-xs",children:"LIVE"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:124,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:120,columnNumber:21},void 0),e.jsxDEV("div",{className:"flex items-center gap-3 text-xs text-gray-600",children:[e.jsxDEV("div",{className:"flex items-center gap-1",children:[e.jsxDEV(Ce,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:131,columnNumber:25},void 0),e.jsxDEV("span",{children:l.viewer_count},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:132,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:130,columnNumber:23},void 0),e.jsxDEV("div",{className:"flex items-center gap-1",children:[e.jsxDEV(Ve,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:135,columnNumber:25},void 0),e.jsxDEV("span",{children:lr(new Date(l.created_at),{addSuffix:!1})},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:136,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:134,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:129,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:119,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:110,columnNumber:17},void 0),l.title&&e.jsxDEV("h4",{className:"font-medium text-sm mb-2 line-clamp-2",children:l.title},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:143,columnNumber:19},void 0),l.description&&e.jsxDEV("p",{className:"text-xs text-gray-600 mb-3 line-clamp-2",children:l.description},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:149,columnNumber:19},void 0),e.jsxDEV(_,{onClick:()=>r(l),size:"sm",className:"w-full bg-red-500 hover:bg-red-600",children:[e.jsxDEV(Ge,{className:"h-3 w-3 mr-2"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:159,columnNumber:19},void 0),"Watch Stream"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:154,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:109,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:102,columnNumber:13},void 0)]},l.id,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:87,columnNumber:9},void 0))},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamMarkers.tsx",lineNumber:85,columnNumber:5},void 0)},Ao=({stream:s,isOpen:a,onClose:o})=>{const{leaveStreamAsViewer:t}=Es(),[i,n]=d.useState(!1);d.useEffect(()=>{s&&a&&n(!0)},[s,a]);const r=async()=>{s&&i&&(await t(s.id),n(!1)),o()};return s?e.jsxDEV(Ma,{open:a,onOpenChange:r,children:e.jsxDEV(Ca,{className:"sm:max-w-4xl h-[80vh] p-0",children:e.jsxDEV("div",{className:"flex flex-col h-full",children:[e.jsxDEV(La,{className:"p-4 border-b flex-shrink-0",children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV(tr,{className:"h-10 w-10 ring-2 ring-red-500",children:[e.jsxDEV(nr,{src:s.profiles?.avatar_url||void 0},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:50,columnNumber:19},void 0),e.jsxDEV(ir,{children:s.profiles?.name?.charAt(0)||s.profiles?.username?.charAt(0)||"U"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:51,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:49,columnNumber:17},void 0),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(Ia,{className:"text-lg",children:s.profiles?.name||s.profiles?.username||"Anonymous"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:59,columnNumber:21},void 0),e.jsxDEV(Ne,{variant:"destructive",className:"text-xs",children:"LIVE"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:62,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:58,columnNumber:19},void 0),e.jsxDEV("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxDEV("div",{className:"flex items-center gap-1",children:[e.jsxDEV(Ce,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:69,columnNumber:23},void 0),e.jsxDEV("span",{children:[s.viewer_count," viewers"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:70,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:68,columnNumber:21},void 0),e.jsxDEV("div",{className:"flex items-center gap-1",children:[e.jsxDEV(Ve,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:73,columnNumber:23},void 0),e.jsxDEV("span",{children:lr(new Date(s.created_at),{addSuffix:!0})},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:74,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:72,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:67,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:57,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:48,columnNumber:15},void 0),e.jsxDEV(_,{variant:"ghost",size:"icon",onClick:r,children:e.jsxDEV(we,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:81,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:80,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:47,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:46,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxDEV("div",{className:"flex-1 bg-black flex items-center justify-center",children:e.jsxDEV("div",{className:"text-white text-center",children:[e.jsxDEV("div",{className:"w-16 h-16 border-4 border-red-500 rounded-full flex items-center justify-center mb-4 mx-auto",children:e.jsxDEV("div",{className:"w-8 h-8 bg-red-500 rounded-full animate-pulse"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:93,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:92,columnNumber:17},void 0),e.jsxDEV("p",{className:"text-lg font-semibold mb-2",children:"Live Stream"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:95,columnNumber:17},void 0),e.jsxDEV("p",{className:"text-sm text-gray-300",children:"This is where the actual video stream would appear"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:96,columnNumber:17},void 0),e.jsxDEV("p",{className:"text-xs text-gray-400 mt-2",children:"Video streaming integration would be implemented here"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:99,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:91,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:89,columnNumber:13},void 0),e.jsxDEV("div",{className:"w-80 bg-background border-l p-4 flex flex-col",children:[s.title&&e.jsxDEV("div",{className:"mb-4",children:[e.jsxDEV("h3",{className:"font-semibold mb-2",children:"Stream Title"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:109,columnNumber:19},void 0),e.jsxDEV("p",{className:"text-sm",children:s.title},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:110,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:108,columnNumber:17},void 0),s.description&&e.jsxDEV("div",{className:"mb-4",children:[e.jsxDEV("h3",{className:"font-semibold mb-2",children:"Description"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:116,columnNumber:19},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:s.description},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:117,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:115,columnNumber:17},void 0),e.jsxDEV("div",{className:"mb-4",children:[e.jsxDEV("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsxDEV(he,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:123,columnNumber:19},void 0),"Location Tracking"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:122,columnNumber:17},void 0),e.jsxDEV("div",{className:"space-y-2 text-sm",children:[e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"text-muted-foreground",children:"Started at:"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:128,columnNumber:21},void 0),e.jsxDEV("br",{},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:129,columnNumber:21},void 0),e.jsxDEV("span",{className:"font-mono text-xs",children:[s.start_lat.toFixed(6),", ",s.start_lng.toFixed(6)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:130,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:127,columnNumber:19},void 0),e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"text-muted-foreground",children:"Current location:"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:135,columnNumber:21},void 0),e.jsxDEV("br",{},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:136,columnNumber:21},void 0),e.jsxDEV("span",{className:"font-mono text-xs",children:[s.current_lat.toFixed(6),", ",s.current_lng.toFixed(6)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:137,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:134,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:126,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:121,columnNumber:15},void 0),e.jsxDEV("div",{className:"mt-auto",children:e.jsxDEV("p",{className:"text-xs text-muted-foreground text-center",children:"Watch the streamer's location update in real-time on the map"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:145,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:144,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:106,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:87,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:44,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:43,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamViewer.tsx",lineNumber:42,columnNumber:5},void 0):null},Po=()=>{const[s,a]=d.useState(null),[o,t]=d.useState(!1),i=d.useCallback(m=>{if(o&&m.latLng){const l={lat:m.latLng?.lat()||0,lng:m.latLng?.lng()||0};a(l),y({title:"Location selected",description:"Now you can create your Lo at this location"})}},[o]);d.useEffect(()=>{const m=pe.on("streetViewClick",l=>{o&&l&&(a(l),y({title:"Street View location selected",description:"Now you can create your Lo at this street view location"}))});return()=>{m()}},[o]);const n=d.useCallback(()=>{t(!0),a(null),y({title:"Place your Lo",description:"Click anywhere on the map or in Street View to select a location"})},[]),r=d.useCallback(()=>{t(!1),a(null)},[]);return{newPinPosition:s,isPlacingPin:o,handleMapClick:i,startPinPlacement:n,endPinPlacement:r,setNewPinPosition:a}},yr=()=>{const s=Ys(),[a,o]=d.useState({lat:34.0522,lng:-118.2437});return d.useEffect(()=>{if(s.state){const{center:t,messageId:i}=s.state;t&&o(t)}},[s.state]),d.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(t=>{s.state?.center||o({lat:t.coords.latitude,lng:t.coords.longitude})},()=>{console.log("Error getting location")})},[s.state]),{userLocation:a}},_o=[{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#333333"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#9b87f5"},{visibility:"on"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f6f7fb"},{lightness:10}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#403E43"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#f1f0fb"},{lightness:15}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#E5DEFF"},{lightness:10}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#d3e4fd"},{lightness:15}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#f2fce2"},{lightness:10}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0EA5E9"},{opacity:.3}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#fec6a1"},{lightness:20}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#F2FCE2"},{lightness:10}]}],$o={styles:_o,disableDefaultUI:!0,zoomControl:!1,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1,scaleControl:!1,rotateControl:!1,draggable:!0,scrollwheel:!0,disableDoubleClickZoom:!1,keyboardShortcuts:!0,gestureHandling:"greedy"},Bs=({isStartingSoon:s=!1,eventCategory:a="general",eventSource:o="ticketmaster",priceRange:t="medium",onClick:i})=>{const r=(c=>{const x={music:{icon:e.jsxDEV(ta,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:23,columnNumber:15},void 0),colors:"from-purple-500 to-pink-600"},sports:{icon:e.jsxDEV(na,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:27,columnNumber:15},void 0),colors:"from-green-500 to-emerald-600"},theater:{icon:e.jsxDEV(ia,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:31,columnNumber:15},void 0),colors:"from-red-500 to-rose-600"},arts:{icon:e.jsxDEV(Ks,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:35,columnNumber:15},void 0),colors:"from-indigo-500 to-purple-600"},family:{icon:e.jsxDEV(la,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:39,columnNumber:15},void 0),colors:"from-orange-500 to-amber-600"},gaming:{icon:e.jsxDEV(ma,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:43,columnNumber:15},void 0),colors:"from-blue-500 to-cyan-600"},general:{icon:e.jsxDEV(is,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:47,columnNumber:15},void 0),colors:"from-amber-500 to-yellow-600"}};return x[c.toLowerCase()]||x.general})(a),m=()=>{switch(t){case"low":return"bg-green-100 border-green-400 text-green-700";case"high":return"bg-red-100 border-red-400 text-red-700";default:return"bg-yellow-100 border-yellow-400 text-yellow-700"}},l=s?{outerGlow:"bg-red-400 animate-pulse shadow-lg shadow-red-400/50",markerBg:"bg-gradient-to-br from-red-500 to-red-700",tailColor:"border-t-red-700",pulseRing:"border-red-400 animate-ping"}:{outerGlow:"bg-amber-400/60 shadow-md shadow-amber-400/30",markerBg:`bg-gradient-to-br ${r.colors}`,tailColor:"border-t-amber-600",pulseRing:"border-amber-400"};return e.jsxDEV("div",{className:`
        group relative cursor-pointer transition-all duration-300 ease-out
        hover:scale-110 active:scale-95 touch-manipulation
        ${s?"animate-bounce":""}
      `,onClick:i,role:"button",tabIndex:0,"aria-label":`${a} event ${s?"(starting soon)":""}`,onKeyDown:c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),i?.())},children:[e.jsxDEV("div",{className:`
          absolute inset-0 rounded-full blur-sm transition-all duration-300
          ${l.outerGlow}
          w-10 h-10 -top-2 -left-2 group-hover:w-12 group-hover:h-12 group-hover:-top-3 group-hover:-left-3
        `},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:100,columnNumber:7},void 0),e.jsxDEV("div",{className:`
        relative w-8 h-8 rounded-full border-3 border-white shadow-xl
        flex items-center justify-center text-white transition-all duration-200
        ${l.markerBg}
        group-hover:shadow-2xl
      `,children:[r.icon,e.jsxDEV("div",{className:`
            absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-white
            ${l.markerBg}
          `,children:e.jsxDEV("div",{className:"w-full h-full rounded-full bg-white/30"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:124,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:118,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:109,columnNumber:7},void 0),e.jsxDEV("div",{className:`
        absolute left-1/2 transform -translate-x-1/2 top-6
        w-0 h-0 border-l-[5px] border-r-[5px] border-t-[8px] border-transparent
        ${l.tailColor}
        drop-shadow-sm
      `},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:129,columnNumber:7},void 0),e.jsxDEV("div",{className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2",children:e.jsxDEV("div",{className:`
          text-xs px-2 py-0.5 rounded-full border font-medium
          ${o==="ticketmaster"?"bg-blue-100 border-blue-400 text-blue-700":"bg-green-100 border-green-400 text-green-700"}
          opacity-0 group-hover:opacity-100 transition-opacity duration-200
        `,children:o==="ticketmaster"?"TM":"EB"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:138,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:137,columnNumber:7},void 0),e.jsxDEV("div",{className:"absolute -top-3 -left-3",children:e.jsxDEV("div",{className:`
          w-4 h-4 rounded-full border-2 text-xs flex items-center justify-center font-bold
          ${m()}
          opacity-0 group-hover:opacity-100 transition-opacity duration-200
        `,children:t==="low"?"$":t==="high"?"$$$":"$$"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:152,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:151,columnNumber:7},void 0),s&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:`absolute inset-0 rounded-full border-2 ${l.pulseRing} w-8 h-8 opacity-75`},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:164,columnNumber:11},void 0),e.jsxDEV("div",{className:`absolute inset-0 rounded-full border-2 ${l.pulseRing} w-8 h-8 animation-delay-75`},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:165,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:163,columnNumber:9},void 0),e.jsxDEV("div",{className:"sr-only",children:[a," event marker. Click to view details.",s&&" This event is starting soon!"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:170,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/map/EventMarkerIcon.tsx",lineNumber:82,columnNumber:5},void 0)},Ro={lat:34.0522,lng:-118.2437},Fo=({title:s,description:a,actionLabel:o,onRetry:t})=>e.jsxDEV("div",{className:"flex h-full w-full flex-col items-center justify-center gap-4 bg-slate-900 px-6 text-center text-white",children:[e.jsxDEV("div",{className:"max-w-md",children:[e.jsxDEV("h2",{className:"text-2xl font-semibold",children:s},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:40,columnNumber:7},void 0),e.jsxDEV("p",{className:"mt-2 text-sm text-slate-300",children:a},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:41,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:39,columnNumber:5},void 0),t?e.jsxDEV("button",{type:"button",onClick:t,className:"rounded-full bg-white/10 px-5 py-2 text-sm font-medium text-white transition hover:bg-white/20",children:o??"Retry"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:44,columnNumber:7},void 0):null,e.jsxDEV("a",{href:"/diagnostic",className:"text-xs font-medium text-slate-300 underline underline-offset-4 hover:text-white",children:"Open Google Maps diagnostics"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:52,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:38,columnNumber:3},void 0),jr=xe.forwardRef(({isEventsOnlyMode:s=!1},a)=>{const{userLocation:o}=yr(),{filters:t,filteredMessages:i,addMessage:n,updateMessage:r,handleFilterChange:m,updateBounds:l}=ar(),{events:c,eventsStartingSoon:x}=mr(),{user:u}=Ae(),{setMap:h}=qs(),[v,p]=d.useState(null),[g,N]=d.useState(!1),{liveStreams:b}=Es(),[w,f]=d.useState(null),[D,E]=d.useState(null),[k,V]=d.useState(!1),{selectedMessage:C,setSelectedMessage:U,isCreating:$,setIsCreating:P,handleClose:O}=cr(),{map:R,isInStreetView:W,onLoad:F,onUnmount:L,onSearchBoxLoad:T}=ur(),{isLoaded:Y,loadError:Q,retry:re}=Hs(),H=d.useCallback(A=>{if(!A){l(null);return}const oe=A.getBounds();if(!oe)return;const ne=oe.getNorthEast(),Ee=oe.getSouthWest();l({north:ne.lat(),south:Ee.lat(),east:ne.lng(),west:Ee.lng()})},[l]),ee=d.useCallback(A=>{A.setOptions({gestureHandling:"greedy",draggable:!0,scrollwheel:!0}),F(A),h(A),H(A)},[F,h,H]),{newPinPosition:K,isPlacingPin:M,handleMapClick:B,startPinPlacement:I,endPinPlacement:j,setNewPinPosition:z}=Po();xe.useImperativeHandle(a,()=>({panTo:A=>{R&&(R.panTo(A),R.setZoom(15))}}),[R]),d.useEffect(()=>{if(!R)return;const A=R.addListener("idle",()=>H(R));return H(R),()=>A.remove()},[R,H]),d.useEffect(()=>pe.on("navigateToMessage",A=>{!R||!A||(R.panTo({lat:A.lat,lng:A.lng}),R.getZoom()&&R.getZoom()<15&&R.setZoom(15),A.messageId&&U(A.messageId))}),[R,U]);const X=d.useCallback(()=>{if(P(!0),I(),U(null),W&&R){const oe=R.getStreetView().getPosition();if(oe){const ne={lat:oe.lat(),lng:oe.lng()};z(ne)}}},[W,R,P,z,U,I]);d.useEffect(()=>pe.on("createMessage",X),[X]);const ae=A=>{U(A),$&&(P(!1),j())},Z=A=>{E(A),V(!0)},S=()=>{V(!1),E(null)},q=A=>{p(A),N(!0)},se=()=>{N(!1),p(null)},te=o||Ro;if(Q)return e.jsxDEV(Fo,{title:"Unable to load Google Maps",description:Q.message||"An unexpected error occurred while loading the map.",actionLabel:"Retry",onRetry:re},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:235,columnNumber:7},void 0);if(!Y)return e.jsxDEV("div",{className:"flex h-full w-full items-center justify-center bg-slate-900",children:e.jsxDEV("div",{className:"text-center text-white",children:[e.jsxDEV("div",{className:"mx-auto mb-4 h-12 w-12 animate-spin rounded-full border-b-2 border-white/80"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:248,columnNumber:11},void 0),e.jsxDEV("h2",{className:"text-xl font-semibold",children:"Loading Google Maps‚Ä¶"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:249,columnNumber:11},void 0),e.jsxDEV("p",{className:"mt-2 text-sm text-white/70",children:"Preparing location data and controls."},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:250,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:247,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:246,columnNumber:7},void 0);const le=u?.user_metadata?.avatar_url||"/placeholder.svg",me=u?.user_metadata?.name,be=`map-container relative w-full h-full ${M?"cursor-pin":""}`;return e.jsxDEV("div",{className:be,children:[e.jsxDEV("div",{className:"absolute inset-0",children:[e.jsxDEV(Pa,{filters:t,onFilterChange:m,onSearchBoxLoad:T,map:R},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:267,columnNumber:9},void 0),e.jsxDEV($a,{map:R,isPlacingPin:M,setNewPinPosition:z,onCreateMessage:X},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:274,columnNumber:9},void 0),e.jsxDEV(Gs,{mapContainerClassName:"w-full h-full",center:te,zoom:13,onLoad:ee,onUnmount:()=>{l(null),h(null),L()},onClick:B,options:$o,children:s?e.jsxDEV(e.Fragment,{children:c.map(A=>{if(A.lat==null||A.lng==null)return null;const oe=x.some(ne=>ne.id===A.id);return e.jsxDEV($e,{position:{lat:A.lat,lng:A.lng},mapPaneName:$e.OVERLAY_MOUSE_TARGET,children:e.jsxDEV("div",{style:{position:"absolute",transform:"translate(-50%, -100%)",zIndex:40},children:e.jsxDEV(Bs,{isStartingSoon:oe,onClick:()=>q(A)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:318,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:311,columnNumber:21},void 0)},A.id,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:306,columnNumber:19},void 0)})},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:297,columnNumber:13},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Io,{selectedMessage:C,filteredMessages:i,onMessageClick:ae,onClose:O},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:330,columnNumber:15},void 0),e.jsxDEV(To,{liveStreams:b,onStreamSelect:Z,selectedStreamId:w,setSelectedStreamId:f},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:337,columnNumber:15},void 0),c.map(A=>{if(A.lat==null||A.lng==null)return null;const oe=x.some(ne=>ne.id===A.id);return e.jsxDEV($e,{position:{lat:A.lat,lng:A.lng},mapPaneName:$e.OVERLAY_MOUSE_TARGET,children:e.jsxDEV("div",{style:{position:"absolute",transform:"translate(-50%, -100%)",zIndex:40},children:e.jsxDEV(Bs,{isStartingSoon:oe,onClick:()=>q(A)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:365,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:358,columnNumber:21},void 0)},A.id,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:353,columnNumber:19},void 0)})]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:329,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:281,columnNumber:9},void 0),!s&&e.jsxDEV(Lo,{isCreating:$,isInStreetView:W,isPlacingPin:M,newPinPosition:K,userAvatar:le,userName:me,handleClose:O,handleCreateMessage:X,addMessage:n,updateMessage:r},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:379,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:266,columnNumber:9},void 0),!s&&e.jsxDEV(e.Fragment,{children:e.jsxDEV(Ao,{stream:D,isOpen:k,onClose:S},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:399,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:397,columnNumber:9},void 0),e.jsxDEV(Ta,{event:v,isOpen:g,onClose:se},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:408,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/MapView.tsx",lineNumber:264,columnNumber:5},void 0)});jr.displayName="MapView";const Se=[{id:"new-york",name:"New York",displayName:"NYC",coordinates:{lat:40.7128,lng:-74.006},radius:30,population:83e5,timezone:"America/New_York",state:"NY",ticketmasterMarketId:"35"},{id:"los-angeles",name:"Los Angeles",displayName:"LA",coordinates:{lat:34.0522,lng:-118.2437},radius:35,population:39e5,timezone:"America/Los_Angeles",state:"CA",ticketmasterMarketId:"27"},{id:"chicago",name:"Chicago",displayName:"Chicago",coordinates:{lat:41.8781,lng:-87.6298},radius:25,population:27e5,timezone:"America/Chicago",state:"IL",ticketmasterMarketId:"8"},{id:"houston",name:"Houston",displayName:"Houston",coordinates:{lat:29.7604,lng:-95.3698},radius:30,population:23e5,timezone:"America/Chicago",state:"TX",ticketmasterMarketId:"18"},{id:"phoenix",name:"Phoenix",displayName:"Phoenix",coordinates:{lat:33.4484,lng:-112.074},radius:25,population:16e5,timezone:"America/Phoenix",state:"AZ",ticketmasterMarketId:"17"},{id:"philadelphia",name:"Philadelphia",displayName:"Philly",coordinates:{lat:39.9526,lng:-75.1652},radius:20,population:16e5,timezone:"America/New_York",state:"PA",ticketmasterMarketId:"29"},{id:"san-antonio",name:"San Antonio",displayName:"San Antonio",coordinates:{lat:29.4241,lng:-98.4936},radius:20,population:15e5,timezone:"America/Chicago",state:"TX",ticketmasterMarketId:"59"},{id:"san-diego",name:"San Diego",displayName:"San Diego",coordinates:{lat:32.7157,lng:-117.1611},radius:25,population:14e5,timezone:"America/Los_Angeles",state:"CA",ticketmasterMarketId:"37"},{id:"dallas",name:"Dallas",displayName:"Dallas",coordinates:{lat:32.7767,lng:-96.797},radius:30,population:13e5,timezone:"America/Chicago",state:"TX",ticketmasterMarketId:"11"},{id:"san-jose",name:"San Jose",displayName:"Bay Area",coordinates:{lat:37.3382,lng:-121.8863},radius:25,population:1e6,timezone:"America/Los_Angeles",state:"CA",ticketmasterMarketId:"41"},{id:"atlanta",name:"Atlanta",displayName:"Atlanta",coordinates:{lat:33.749,lng:-84.388},radius:30,population:5e5,timezone:"America/New_York",state:"GA",ticketmasterMarketId:"1"},{id:"miami",name:"Miami",displayName:"Miami",coordinates:{lat:25.7617,lng:-80.1918},radius:25,population:47e4,timezone:"America/New_York",state:"FL",ticketmasterMarketId:"21"},{id:"denver",name:"Denver",displayName:"Denver",coordinates:{lat:39.7392,lng:-104.9903},radius:25,population:715e3,timezone:"America/Denver",state:"CO",ticketmasterMarketId:"12"},{id:"seattle",name:"Seattle",displayName:"Seattle",coordinates:{lat:47.6062,lng:-122.3321},radius:25,population:75e4,timezone:"America/Los_Angeles",state:"WA",ticketmasterMarketId:"49"},{id:"las-vegas",name:"Las Vegas",displayName:"Las Vegas",coordinates:{lat:36.1699,lng:-115.1398},radius:20,population:65e4,timezone:"America/Los_Angeles",state:"NV",ticketmasterMarketId:"20"}];[...Se];function Ye(s,a,o,t){const n=Oe(o-s),r=Oe(t-a),m=Math.sin(n/2)*Math.sin(n/2)+Math.cos(Oe(s))*Math.cos(Oe(o))*Math.sin(r/2)*Math.sin(r/2);return 3959*(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)))}function Oe(s){return s*(Math.PI/180)}function us(s,a,o={}){console.log(`üîç CITY DETECTION: Starting detection for location ${s}, ${a}`);let t=Se[0],i=1/0;console.log(`üîç CITY DETECTION: Checking ${Se.length} cities...`);const n=Ye(s,a,33.749,-84.388);console.log(`üîç SPECIAL CHECK: Distance to Atlanta (33.7490, -84.3880): ${Math.round(n)} miles`);for(const r of Se){const m=Ye(s,a,r.coordinates.lat,r.coordinates.lng);console.log(`üîç ${r.displayName} (${r.id}): ${Math.round(m)} miles away (coords: ${r.coordinates.lat}, ${r.coordinates.lng})`),m<i&&(i=m,t=r,console.log(`üéØ NEW CLOSEST: ${r.displayName} (${r.id}) at ${Math.round(m)} miles`))}return console.log(`‚úÖ FINAL RESULT: ${t.displayName} (${t.id}) is ${Math.round(i)} miles away`),t}function Oo(s,a,o=50){console.log(`üîç EVENT RADIUS CHECK: Testing location ${s}, ${a} within ${o} miles`);let t=1/0,i="";for(const n of Se){const r=Ye(s,a,n.coordinates.lat,n.coordinates.lng);if(r<t&&(t=r,i=n.displayName),console.log(`üîç ${n.displayName}: ${Math.round(r)} miles away`),r<=o)return console.log(`‚úÖ WITHIN RADIUS: ${n.displayName} is within ${o} miles`),!0}return console.log(`‚ùå OUTSIDE RADIUS: Closest city ${i} is ${Math.round(t)} miles away (max: ${o})`),!1}function Bo(s){return`${{"new-york":"üóΩ","los-angeles":"üå¥",chicago:"üèôÔ∏è",houston:"üöÄ",phoenix:"üåµ",philadelphia:"üîî","san-antonio":"ü§†","san-diego":"üèñÔ∏è",dallas:"ü§†","san-jose":"üíª",atlanta:"üçë",miami:"üèñÔ∏è",denver:"‚õ∞Ô∏è",seattle:"‚òï","las-vegas":"üé∞"}[s.id]||"üèôÔ∏è"} ${s.displayName}`}function zo(s,a){const o=us(s,a),t=Ye(s,a,o.coordinates.lat,o.coordinates.lng);return t>50?Math.min(100,t+o.radius):o.population>1e6?Math.max(o.radius,35):o.radius}const qo=s=>{const[a,o]=d.useState(null),[t,i]=d.useState(null),[n,r]=d.useState(!0),[m,l]=d.useState(50),[c,x]=d.useState({preferLargeMetros:!0}),u=d.useCallback(()=>{if(!s)return;const N=s.getCenter();if(!N)return;const b=N.lat(),w=N.lng();console.log(`üó∫Ô∏è MAP CENTER: Detecting city from map center: ${b}, ${w}`),i({lat:b,lng:w});const f=zo(b,w);l(f);const D=Oo(b,w,150);if(r(D),console.log(`üó∫Ô∏è MAP CENTER: Within range of major cities: ${D} (optimal radius: ${f} miles)`),D){const E=us(b,w,{maxDistance:200,preferLargeMetros:c.preferLargeMetros});o(E);const k=Math.round(h(b,w,E.coordinates.lat,E.coordinates.lng));console.log(`üéØ MAP CITY: Detected ${E.displayName} (${E.id}) from map position`),console.log(`üéØ MAP CITY: Distance to ${E.displayName}: ${k} miles (metro: ${E.metroArea})`),console.log(`üéØ MAP CITY: Using radius: ${E.radius} miles, TM Market: ${E.ticketmasterMarketId||"N/A"}`)}else{const E=us(b,w,{maxDistance:500,preferLargeMetros:!0}),k=h(b,w,E.coordinates.lat,E.coordinates.lng);k<=300?(o(E),console.log(`üó∫Ô∏è FALLBACK CITY: Using ${E.displayName} (${Math.round(k)} miles away) for remote location`)):(o(null),console.log(`üó∫Ô∏è MAP CENTER: Location too remote - no events available (nearest: ${E.displayName} at ${Math.round(k)} miles)`))}},[s]),h=(N,b,w,f)=>{const E=v(w-N),k=v(f-b),V=Math.sin(E/2)*Math.sin(E/2)+Math.cos(v(N))*Math.cos(v(w))*Math.sin(k/2)*Math.sin(k/2);return 3959*(2*Math.atan2(Math.sqrt(V),Math.sqrt(1-V)))},v=N=>N*(Math.PI/180);d.useEffect(()=>{if(!s)return;console.log("üó∫Ô∏è MAP SETUP: Setting up map center detection listeners"),u();const N=s.addListener("center_changed",()=>{setTimeout(u,500)}),b=s.addListener("zoom_changed",()=>{setTimeout(u,500)}),w=s.addListener("idle",()=>{u()});return console.log("üó∫Ô∏è MAP SETUP: Map listeners registered successfully"),()=>{google.maps.event.removeListener(N),google.maps.event.removeListener(b),google.maps.event.removeListener(w),console.log("üó∫Ô∏è MAP CLEANUP: Removed map listeners")}},[s,u]);const p=d.useCallback(()=>{u()},[u]),g=d.useCallback(N=>{x(b=>({...b,...N})),setTimeout(()=>u(),100)},[u]);return{currentCity:a,mapCenter:t,isWithinRange:n,searchRadius:m,updateCityDetection:p,updateDetectionOptions:g,detectionOptions:c}},Ho=({className:s="",onEventsOnlyModeChange:a})=>{const[o,t]=d.useState(!1),[i,n]=d.useState(!1),[r,m]=d.useState(0),[l,c]=d.useState(!1),{events:x,refetch:u}=mr(),{map:h}=qs(),{currentCity:v,isWithinRange:p,mapCenter:g}=qo(h);d.useEffect(()=>{const f=x.filter(D=>{const E=new Date(D.event_start_date),k=new Date,V=new Date(k.getTime()+24*60*60*1e3);return E>=k&&E<=V});n(f.length>0),m(f.length)},[x]);const N=async()=>{i&&l?(await w(),c(!1),n(!1),m(0),a?.(!1),y({title:"üó∫Ô∏è Map Restored",description:"All content is now visible on the map",duration:2e3})):(c(!0),a?.(!0),i?(await w(),setTimeout(()=>b(),500)):await b())},b=async()=>{if(!v){y({title:"üìç Location Required",description:"Detecting your location to find nearby events...",duration:3e3});return}t(!0);try{const{data:f,error:D}=await G.functions.invoke("fetch-events-realtime",{body:{source:["ticketmaster","predicthq"],center:v.coordinates,radius:v.radius,timeframe:"24h"}});if(D)throw D;await u(),n(!0),m(f?.events?.total||f?.totalEvents||0),y({title:`üé´ ${Bo(v)} Events Only!`,description:`Showing ${f?.events?.total||f?.totalEvents||0} events in ${v.displayName} ‚Ä¢ Other content hidden for better performance`,duration:3e3})}catch(f){console.error("Error loading events:",f),f.message?.includes("Edge Function returned a non-2xx status code")||f.message?.includes("NOT_FOUND")?(y({title:"üîß Setup Required",description:"Please deploy the events function. Check console for instructions.",duration:5e3}),console.info(`
üîß EVENTS SETUP REQUIRED:

The events function needs to be deployed:

1. Deploy function: supabase functions deploy fetch-events-realtime
2. Set environment variables:
   - TICKETMASTER_API_KEY=your_api_key
   - EVENTBRITE_PRIVATE_TOKEN=your_eventbrite_token
   - SUPABASE_SERVICE_ROLE_KEY=your_service_key
3. Ensure database migration is applied

See REALTIME_EVENTS_SETUP.md for detailed instructions.
        `)):y({title:"‚ùå Connection Error",description:"Failed to connect to event services. Please try again.",variant:"destructive",duration:4e3})}finally{t(!1)}},w=async()=>{t(!0);try{console.log("üßπ Clearing all events...");const{error:f}=await G.from("messages").delete().eq("message_type","event").in("event_source",["ticketmaster","seatgeek","predicthq","yelp","eventbrite"]);if(f)throw f;await u(),y({title:"üßπ Events Hidden",description:"All events have been removed from the map",duration:2e3})}catch(f){console.error("Error clearing events:",f),y({title:"‚ùå Clear Error",description:"Failed to clear events from map",variant:"destructive"})}finally{t(!1)}};return e.jsxDEV("div",{className:`flex flex-col items-center space-y-3 ${s}`,children:e.jsxDEV("button",{onClick:N,disabled:o,className:`
          relative flex min-h-[36px] min-w-[80px] items-center justify-center rounded-xl border px-3 py-2 text-xs font-semibold text-white transition-transform duration-200
          backdrop-blur-xl
          ${i&&l?"bg-gradient-to-r from-purple-600/30 to-indigo-500/30 border-purple-400/40":i?"bg-gradient-to-r from-emerald-500/30 to-teal-500/30 border-emerald-400/40":"bg-gradient-to-r from-amber-400/30 to-yellow-400/30 border-amber-300/40"}
          ${o?"scale-95 opacity-80":"hover:scale-[1.02] active:scale-95"}
          disabled:cursor-not-allowed disabled:transform-none disabled:opacity-60
        `,children:[i&&e.jsxDEV("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-transparent via-white/10 to-transparent"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/events/EventsToggle.tsx",lineNumber:204,columnNumber:11},void 0),e.jsxDEV("div",{className:"relative flex items-center space-x-1",children:[o?e.jsxDEV(rr,{className:"w-4 h-4 animate-spin"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/events/EventsToggle.tsx",lineNumber:209,columnNumber:13},void 0):i?e.jsxDEV("div",{className:"flex items-center space-x-1",children:[e.jsxDEV("div",{className:"w-2 h-2 bg-white rounded-full motion-safe:animate-pulse"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/events/EventsToggle.tsx",lineNumber:212,columnNumber:15},void 0),e.jsxDEV(is,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/events/EventsToggle.tsx",lineNumber:213,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/events/EventsToggle.tsx",lineNumber:211,columnNumber:13},void 0):e.jsxDEV(is,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/events/EventsToggle.tsx",lineNumber:216,columnNumber:13},void 0),e.jsxDEV("span",{className:"text-xs leading-tight font-semibold",children:o?"Loading":i&&l?"Exit":i?"Only":"Events"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/events/EventsToggle.tsx",lineNumber:219,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/events/EventsToggle.tsx",lineNumber:207,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/events/EventsToggle.tsx",lineNumber:186,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/events/EventsToggle.tsx",lineNumber:184,columnNumber:5},void 0)},Yo=({onStreamStart:s,onStreamEnd:a,onClose:o,isStreaming:t,viewerCount:i=0,streamTitle:n="",onTitleChange:r})=>{const m=d.useRef(null),l=d.useRef(null),[c,x]=d.useState(null),[u,h]=d.useState(!0),[v,p]=d.useState(!0),[g,N]=d.useState("user"),[b,w]=d.useState([]),[f,D]=d.useState(!1),[E,k]=d.useState(0),[V,C]=d.useState(n),[U,$]=d.useState(!1),[P,O]=d.useState(!1);d.useEffect(()=>{let M;return t?M=setInterval(()=>{k(B=>B+1)},1e3):k(0),()=>clearInterval(M)},[t]),d.useEffect(()=>{(async()=>{try{const I=(await navigator.mediaDevices.enumerateDevices()).filter(j=>j.kind==="videoinput");w(I)}catch(B){console.error("Error getting devices:",B)}})()},[]),d.useEffect(()=>(!U&&!P&&R(),()=>{T()}),[g]);const R=async()=>{$(!0)},W=async()=>{$(!1),O(!1),await L()},F=()=>{$(!1),O(!0),x(!1)},L=async()=>{try{D(!0),l.current&&l.current.getTracks().forEach(I=>I.stop());const M={video:{facingMode:g,width:{ideal:1280},height:{ideal:720},frameRate:{ideal:30}},audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}},B=await navigator.mediaDevices.getUserMedia(M);l.current=B,m.current&&(m.current.srcObject=B,m.current.play()),x(!0),O(!1),y({title:"Camera & Microphone Ready!",description:"You can now start livestreaming"})}catch(M){console.error("Error accessing camera:",M),x(!1),O(!0);let B="Please allow camera and microphone access";M.name==="NotAllowedError"?B="Camera and microphone access was denied. Please enable permissions in your browser settings.":M.name==="NotFoundError"?B="No camera or microphone found on this device.":M.name==="NotReadableError"&&(B="Camera or microphone is already in use by another application."),y({title:"Camera & Microphone Access Required",description:B,variant:"destructive"})}finally{D(!1)}},T=()=>{l.current&&(l.current.getTracks().forEach(M=>M.stop()),l.current=null),m.current&&(m.current.srcObject=null)},Y=()=>{if(l.current){const M=l.current.getVideoTracks()[0];M&&(M.enabled=!M.enabled,h(M.enabled))}},Q=()=>{if(l.current){const M=l.current.getAudioTracks()[0];M&&(M.enabled=!M.enabled,p(M.enabled))}},re=()=>{N(M=>M==="user"?"environment":"user")},H=()=>{if(!l.current){y({title:"Camera not ready",description:"Please wait for camera to initialize",variant:"destructive"});return}if(!V.trim()){y({title:"Title required",description:"Please add a title for your livestream",variant:"destructive"});return}s?.(l.current),r?.(V),y({title:"Live stream started!",description:"You're now broadcasting live to your location"})},ee=()=>{a?.(),k(0),y({title:"Live stream ended",description:"Your broadcast has been stopped"})},K=M=>{const B=Math.floor(M/60),I=M%60;return`${B.toString().padStart(2,"0")}:${I.toString().padStart(2,"0")}`};return U?e.jsxDEV("div",{className:"text-center p-8 bg-gradient-to-br from-red-50 to-orange-50 rounded-lg border border-red-200",children:[e.jsxDEV("div",{className:"w-16 h-16 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsxDEV(ge,{className:"h-8 w-8 text-white"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:251,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:250,columnNumber:9},void 0),e.jsxDEV("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Camera & Microphone Access Required"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:253,columnNumber:9},void 0),e.jsxDEV("p",{className:"text-gray-600 mb-4 text-sm leading-relaxed",children:'To start livestreaming, this app needs access to your camera and microphone. Your browser will ask for permission when you click "Allow Access".'},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:254,columnNumber:9},void 0),e.jsxDEV("div",{className:"space-y-2 text-xs text-gray-500 mb-6",children:[e.jsxDEV("div",{className:"flex items-center justify-center space-x-1",children:[e.jsxDEV(ge,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:260,columnNumber:13},void 0),e.jsxDEV("span",{children:"Camera: To broadcast your video"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:261,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:259,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex items-center justify-center space-x-1",children:[e.jsxDEV(ze,{className:"h-3 w-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:264,columnNumber:13},void 0),e.jsxDEV("span",{children:"Microphone: To broadcast your audio"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:263,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:258,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex space-x-3 justify-center",children:[e.jsxDEV("button",{onClick:F,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors",children:"Cancel"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:269,columnNumber:11},void 0),e.jsxDEV("button",{onClick:W,className:"px-6 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors flex items-center space-x-2",children:[e.jsxDEV("span",{children:"Allow Access"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:279,columnNumber:13},void 0),e.jsxDEV(ge,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:280,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:275,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:268,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:249,columnNumber:7},void 0):c===null?e.jsxDEV("div",{className:"flex items-center justify-center p-8",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:290,columnNumber:9},void 0),e.jsxDEV("span",{className:"ml-3 text-gray-600",children:"Setting up camera..."},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:291,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:289,columnNumber:7},void 0):c===!1||P?e.jsxDEV("div",{className:"text-center p-8 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxDEV(qe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:299,columnNumber:9},void 0),e.jsxDEV("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Camera & Microphone Access Denied"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:300,columnNumber:9},void 0),e.jsxDEV("p",{className:"text-gray-600 mb-4 text-sm leading-relaxed",children:"Livestreaming requires camera and microphone permissions. Please:"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:301,columnNumber:9},void 0),e.jsxDEV("div",{className:"text-left text-xs text-gray-600 bg-white p-3 rounded border mb-6 space-y-1",children:[e.jsxDEV("div",{children:"1. Click the camera icon in your browser's address bar"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:305,columnNumber:11},void 0),e.jsxDEV("div",{children:'2. Select "Allow" for both camera and microphone'},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:306,columnNumber:11},void 0),e.jsxDEV("div",{children:"3. Refresh the page if needed"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:307,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:304,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex space-x-3 justify-center",children:[e.jsxDEV("button",{onClick:()=>$(!0),className:"px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium transition-colors",children:"Try Again"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:310,columnNumber:11},void 0),o&&e.jsxDEV("button",{onClick:o,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors",children:"Cancel"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:317,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:309,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:298,columnNumber:7},void 0):e.jsxDEV("div",{className:"relative bg-black rounded-lg overflow-hidden",children:[e.jsxDEV("div",{className:"relative aspect-video",children:[e.jsxDEV("video",{ref:m,className:"w-full h-full object-cover",muted:!0,playsInline:!0},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:333,columnNumber:9},void 0),f&&e.jsxDEV("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:e.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:343,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:342,columnNumber:11},void 0),t&&e.jsxDEV("div",{className:"absolute top-4 left-4 right-4 flex justify-between items-center",children:[e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV("div",{className:"flex items-center bg-red-500 text-white px-2 py-1 rounded-full text-sm font-bold",children:[e.jsxDEV("div",{className:"w-2 h-2 bg-white rounded-full mr-1 animate-pulse"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:353,columnNumber:17},void 0),"LIVE"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:352,columnNumber:15},void 0),e.jsxDEV("span",{className:"bg-black/50 text-white px-2 py-1 rounded text-sm",children:K(E)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:356,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:351,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center bg-black/50 text-white px-2 py-1 rounded text-sm",children:[e.jsxDEV(Ge,{className:"h-3 w-3 mr-1"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:363,columnNumber:15},void 0),i]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:362,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:349,columnNumber:11},void 0),o&&e.jsxDEV("button",{onClick:o,className:"absolute top-4 right-4 p-2 bg-black/50 hover:bg-black/70 text-white rounded-full transition-colors",children:e.jsxDEV(we,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:375,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:371,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:332,columnNumber:7},void 0),e.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[e.jsxDEV("input",{type:"text",value:V,onChange:M=>C(M.target.value),placeholder:"What's your stream about?",className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500",maxLength:100,disabled:t},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:382,columnNumber:9},void 0),e.jsxDEV("div",{className:"text-right text-xs text-gray-500 mt-1",children:[V.length,"/100"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:391,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:381,columnNumber:7},void 0),e.jsxDEV("div",{className:"p-4 bg-gray-50",children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[e.jsxDEV("div",{className:"flex space-x-2",children:[e.jsxDEV("button",{onClick:Y,className:`p-3 rounded-full transition-colors ${u?"bg-emerald-500 hover:bg-emerald-600 text-white":"bg-red-500 hover:bg-red-600 text-white"}`,children:u?e.jsxDEV(ge,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:409,columnNumber:33},void 0):e.jsxDEV(qe,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:409,columnNumber:65},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:401,columnNumber:13},void 0),e.jsxDEV("button",{onClick:Q,className:`p-3 rounded-full transition-colors ${v?"bg-emerald-500 hover:bg-emerald-600 text-white":"bg-red-500 hover:bg-red-600 text-white"}`,children:v?e.jsxDEV(ze,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:420,columnNumber:33},void 0):e.jsxDEV(ts,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:420,columnNumber:63},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:412,columnNumber:13},void 0),b.length>1&&e.jsxDEV("button",{onClick:re,className:"p-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-full transition-colors",disabled:t,children:e.jsxDEV(ua,{className:"h-5 w-5"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:429,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:424,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:400,columnNumber:11},void 0),e.jsxDEV("div",{children:t?e.jsxDEV("button",{onClick:ee,className:"flex items-center space-x-2 px-6 py-3 bg-gray-800 hover:bg-black text-white rounded-full font-semibold transition-colors",children:[e.jsxDEV(er,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:450,columnNumber:17},void 0),e.jsxDEV("span",{children:"End Stream"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:451,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:446,columnNumber:15},void 0):e.jsxDEV("button",{onClick:H,disabled:!c||f,className:"flex items-center space-x-2 px-6 py-3 bg-red-500 hover:bg-red-600 disabled:bg-gray-400 text-white rounded-full font-semibold transition-colors",children:[e.jsxDEV(ca,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:442,columnNumber:17},void 0),e.jsxDEV("span",{children:"Go Live"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:443,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:437,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:435,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:398,columnNumber:9},void 0),t&&e.jsxDEV("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxDEV("div",{className:"flex items-center space-x-4",children:[e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV(Ce,{className:"h-4 w-4 mr-1"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:462,columnNumber:17},void 0),e.jsxDEV("span",{children:[i," viewer",i!==1?"s":""]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:463,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:461,columnNumber:15},void 0),e.jsxDEV("div",{children:["Duration: ",K(E)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:465,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:460,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-emerald-600 font-medium",children:"Broadcasting live"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:467,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:459,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:397,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/livestream/LiveStreamCamera.tsx",lineNumber:330,columnNumber:5},void 0)};class zs{static streams=new Map;static streamConnections=new Map;static async startLiveStream(a,o,t,i=!1){try{const n=(await G.auth.getUser()).data.user;if(!n)throw new Error("User not authenticated");const{data:r}=await G.from("profiles").select("name, avatar_url").eq("id",n.id).single(),m=`stream_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,l=`wss://stream.example.com/live/${m}`,c={id:m,title:o,streamUrl:l,location:t,userId:n.id,userName:r?.name||n.email||"Anonymous",userAvatar:r?.avatar_url,isLive:!0,viewerCount:0,startedAt:new Date().toISOString(),isPrivate:i};this.streams.set(m,c),this.streamConnections.set(m,a);const{error:x}=await G.from("messages").insert({content:o,user_id:n.id,lat:t.lat,lng:t.lng,is_public:!i,message_type:"livestream",livestream_url:l,livestream_title:o,is_live:!0});if(x)throw x;return G.channel("livestreams").send({type:"broadcast",event:"stream_started",payload:c}),console.log("üî¥ LiveStream started:",c),c}catch(n){throw console.error("Error starting livestream:",n),new Error(`Failed to start livestream: ${n.message}`)}}static async endLiveStream(a){try{const o=this.streams.get(a);if(!o)throw new Error("Stream not found");const t=this.streamConnections.get(a);t&&(t.getTracks().forEach(r=>r.stop()),this.streamConnections.delete(a)),o.isLive=!1,o.endedAt=new Date().toISOString();const{error:i}=await G.from("messages").update({is_live:!1,ended_at:o.endedAt}).eq("livestream_url",o.streamUrl);if(i)throw i;G.channel("livestreams").send({type:"broadcast",event:"stream_ended",payload:{streamId:a}}),this.streams.delete(a),o.streamUrl.startsWith("blob:")&&URL.revokeObjectURL(o.streamUrl),console.log("üî¥ LiveStream ended:",a)}catch(o){throw console.error("Error ending livestream:",o),new Error(`Failed to end livestream: ${o.message}`)}}static async getActiveLiveStreams(a){try{let o=G.from("messages").select(`
          id,
          content,
          lat,
          lng,
          created_at,
          livestream_url,
          livestream_title,
          is_live,
          user_id,
          profiles (
            name,
            avatar_url
          )
        `).eq("message_type","livestream").eq("is_live",!0).order("created_at",{ascending:!1});const{data:t,error:i}=await o;if(i)throw i;const n=(t||[]).map(r=>({id:r.id,title:r.livestream_title||r.content,streamUrl:r.livestream_url,location:{lat:r.lat,lng:r.lng,name:"Live Location"},userId:r.user_id,userName:r.profiles?.name||"Anonymous",userAvatar:r.profiles?.avatar_url,isLive:r.is_live,viewerCount:Math.floor(Math.random()*50),startedAt:r.created_at,isPrivate:!1}));return a&&n.sort((r,m)=>{const l=this.calculateDistance(a,r.location),c=this.calculateDistance(a,m.location);return l-c}),n}catch(o){return console.error("Error fetching livestreams:",o),[]}}static async joinLiveStream(a){try{const o=this.streams.get(a);if(o)return o.viewerCount++,o;const{data:t,error:i}=await G.from("messages").select(`
          id,
          content,
          lat,
          lng,
          created_at,
          livestream_url,
          livestream_title,
          is_live,
          user_id,
          profiles (
            name,
            avatar_url
          )
        `).eq("id",a).eq("message_type","livestream").eq("is_live",!0).single();if(i||!t)return null;const n={id:t.id,title:t.livestream_title||t.content,streamUrl:t.livestream_url,location:{lat:t.lat,lng:t.lng,name:"Live Location"},userId:t.user_id,userName:t.profiles?.name||"Anonymous",userAvatar:t.profiles?.avatar_url,isLive:t.is_live,viewerCount:Math.floor(Math.random()*50)+1,startedAt:t.created_at,isPrivate:!1};return this.streams.set(a,n),n}catch(o){return console.error("Error joining livestream:",o),null}}static leaveLiveStream(a){const o=this.streams.get(a);o&&(o.viewerCount=Math.max(0,o.viewerCount-1))}static calculateDistance(a,o){const i=this.toRadians(o.lat-a.lat),n=this.toRadians(o.lng-a.lng),r=Math.sin(i/2)*Math.sin(i/2)+Math.cos(this.toRadians(a.lat))*Math.cos(this.toRadians(o.lat))*Math.sin(n/2)*Math.sin(n/2);return 6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))}static toRadians(a){return a*(Math.PI/180)}static getOptimalStreamSettings(a){switch(a){case"poor":return{quality:"low",frameRate:15,bitrate:5e5};case"good":return{quality:"medium",frameRate:24,bitrate:1e6};case"excellent":return{quality:"high",frameRate:30,bitrate:25e5};default:return{quality:"medium",frameRate:24,bitrate:1e6}}}}const Go=({isOpen:s,onClose:a,onPostCreated:o})=>{const[t,i]=d.useState("type"),[n,r]=d.useState(""),[m,l]=d.useState(null),[c,x]=d.useState(!1),[u,h]=d.useState(!1),[v,p]=d.useState(null),[g,N]=d.useState(null),b=d.useRef(null),[w,f]=d.useState(!1),[D,E]=d.useState(null),[k,V]=d.useState(""),{userLocation:C}=yr(),[U,$]=d.useState(null),[P,O]=d.useState("");d.useState(!1);const{isLoaded:R,loadError:W,apiKeyValid:F}=Hs();d.useEffect(()=>{s&&(i("type"),r(""),l(null),x(!1),p(null),N(null),f(!1),E(null),V(""),$(null),O(""))},[s]),d.useEffect(()=>{C&&!U&&($(C),window.google&&R&&new google.maps.Geocoder().geocode({location:C},(j,z)=>{z==="OK"&&j?.[0]&&O(j[0].formatted_address.split(",")[0])}))},[C,U,R]);const L=I=>{const j=I.target.files?.[0];if(!j)return;if(!j.type.startsWith("image/")&&!j.type.startsWith("video/")){y({title:"Invalid file type",description:"Please select an image or video file",variant:"destructive"});return}const z=j.type.startsWith("video/")?100*1024*1024:5*1024*1024;if(j.size>z){y({title:"File too large",description:`File must be smaller than ${j.type.startsWith("video/")?"100MB":"5MB"}`,variant:"destructive"});return}p(j);const X=new FileReader;X.onloadend=()=>{const ae=X.result;N(ae)},X.readAsDataURL(j)},T=I=>{l(I),i("location")},Y=()=>{if(!U){y({title:"Location required",description:"Please select a location for your Lo",variant:"destructive"});return}i("content")},Q=I=>{if(I.latLng){const j={lat:I.latLng.lat(),lng:I.latLng.lng()};$(j),new google.maps.Geocoder().geocode({location:j},(X,ae)=>{ae==="OK"&&X?.[0]&&O(X[0].formatted_address.split(",")[0])})}},re=async I=>{if(I.preventDefault(),m==="live"){y({title:"Already streaming!",description:"Your livestream is already active"});return}if(!n.trim()&&!v){y({title:"Content required",description:"Please add some content to your Lo",variant:"destructive"});return}if(!U){y({title:"Location required",description:"Please select a location for your Lo",variant:"destructive"});return}h(!0);try{const j={id:`post-${Date.now()}`,content:n.trim(),type:m,mediaUrl:g||void 0,isPrivate:c,location:{lat:U.lat,lng:U.lng,name:P||"Selected Location"},createdAt:new Date().toISOString(),user:{id:"current-user",name:"You",avatar:"/placeholder-avatar.png"}};o?.(j)}catch(j){console.error("Error creating post:",j),y({title:"Failed to post",description:"Please try again",variant:"destructive"})}finally{h(!1)}},H=()=>{p(null),N(null),b.current&&(b.current.value="")};if(!s)return null;const ee=()=>e.jsxDEV("div",{className:"flex items-center justify-center space-x-2 mb-6",children:["type","location","content"].map((I,j)=>e.jsxDEV(xe.Fragment,{children:[e.jsxDEV("div",{className:`flex items-center justify-center w-8 h-8 rounded-full transition-all ${t===I?"bg-lo-teal text-white":j<["type","location","content"].indexOf(t)?"bg-green-500 text-white":"bg-gray-200 text-gray-500"}`,children:j<["type","location","content"].indexOf(t)?e.jsxDEV(Ps,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:241,columnNumber:15},void 0):e.jsxDEV("span",{className:"text-sm font-semibold",children:j+1},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:243,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:233,columnNumber:11},void 0),j<2&&e.jsxDEV("div",{className:`w-12 h-0.5 transition-all ${j<["type","location","content"].indexOf(t)?"bg-green-500":"bg-gray-200"}`},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:247,columnNumber:13},void 0)]},I,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:232,columnNumber:9},void 0))},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:230,columnNumber:5},void 0),K=()=>e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("h3",{className:"text-lg font-semibold text-gray-900 text-center mb-6",children:"What would you like to share?"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:260,columnNumber:7},void 0),e.jsxDEV("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxDEV("button",{type:"button",onClick:()=>T("text"),className:"flex items-center justify-between p-4 rounded-xl border-2 border-gray-200 hover:border-lo-teal hover:bg-lo-teal/5 transition-all group",children:[e.jsxDEV("div",{className:"flex items-center space-x-3",children:[e.jsxDEV("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center",children:e.jsxDEV(ds,{className:"w-6 h-6 text-white"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:272,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:271,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-left",children:[e.jsxDEV("p",{className:"font-semibold text-gray-900",children:"Text Message"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:275,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500",children:"Share your thoughts"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:276,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:274,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:270,columnNumber:11},void 0),e.jsxDEV(De,{className:"w-5 h-5 text-gray-400 group-hover:text-lo-teal transition-colors"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:279,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:265,columnNumber:9},void 0),e.jsxDEV("button",{type:"button",onClick:()=>T("media"),className:"flex items-center justify-between p-4 rounded-xl border-2 border-gray-200 hover:border-lo-teal hover:bg-lo-teal/5 transition-all group",children:[e.jsxDEV("div",{className:"flex items-center space-x-3",children:[e.jsxDEV("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center",children:e.jsxDEV(as,{className:"w-6 h-6 text-white"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:289,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:288,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-left",children:[e.jsxDEV("p",{className:"font-semibold text-gray-900",children:"Photo/Video"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:292,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500",children:"Share visual moments"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:293,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:291,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:287,columnNumber:11},void 0),e.jsxDEV(De,{className:"w-5 h-5 text-gray-400 group-hover:text-lo-teal transition-colors"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:296,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:282,columnNumber:9},void 0),e.jsxDEV("button",{type:"button",onClick:()=>T("live"),className:"flex items-center justify-between p-4 rounded-xl border-2 border-gray-200 hover:border-red-500 hover:bg-red-50 transition-all group",children:[e.jsxDEV("div",{className:"flex items-center space-x-3",children:[e.jsxDEV("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-xl flex items-center justify-center",children:e.jsxDEV(Be,{className:"w-6 h-6 text-white"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:306,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:305,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-left",children:[e.jsxDEV("p",{className:"font-semibold text-gray-900",children:"Go Live"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:309,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500",children:"Stream from your location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:310,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:308,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:304,columnNumber:11},void 0),e.jsxDEV(De,{className:"w-5 h-5 text-gray-400 group-hover:text-red-500 transition-colors"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:313,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:299,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:264,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:259,columnNumber:5},void 0),M=()=>e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[e.jsxDEV("button",{onClick:()=>i("type"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsxDEV(De,{className:"w-5 h-5 text-gray-500 rotate-180"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:326,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:322,columnNumber:9},void 0),e.jsxDEV("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:328,columnNumber:9},void 0),e.jsxDEV("div",{className:"w-9"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:331,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:321,columnNumber:7},void 0),e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("button",{type:"button",onClick:()=>{C&&($(C),new google.maps.Geocoder().geocode({location:C},(j,z)=>{z==="OK"&&j?.[0]&&O(j[0].formatted_address.split(",")[0])}))},className:"w-full flex items-center justify-between p-3 rounded-lg bg-lo-teal/10 border border-lo-teal/30 hover:bg-lo-teal/20 transition-colors",children:[e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(bs,{className:"w-5 h-5 text-lo-teal"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:352,columnNumber:13},void 0),e.jsxDEV("span",{className:"font-medium text-gray-900",children:"Use Current Location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:353,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:351,columnNumber:11},void 0),U&&U.lat===C?.lat&&e.jsxDEV(Ps,{className:"w-5 h-5 text-lo-teal"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:356,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:336,columnNumber:9},void 0),R&&e.jsxDEV("div",{className:"relative",children:[e.jsxDEV("div",{className:"h-64 rounded-xl overflow-hidden border border-gray-200",children:e.jsxDEV(Gs,{mapContainerClassName:"w-full h-full",center:U||C||{lat:40.7128,lng:-74.006},zoom:15,onClick:Q,options:{disableDefaultUI:!0,zoomControl:!0,clickableIcons:!1,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]},children:U&&e.jsxDEV(cs,{position:U,icon:{path:google.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#13D3AA",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2}},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:383,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:364,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:363,columnNumber:13},void 0),e.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Tap on the map to select a different location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:397,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:362,columnNumber:11},void 0),U&&e.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsxDEV("div",{className:"flex items-start space-x-2",children:[e.jsxDEV(he,{className:"w-5 h-5 text-lo-teal mt-0.5"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:407,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("p",{className:"font-medium text-gray-900",children:P||"Selected Location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:409,columnNumber:17},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500",children:[U.lat.toFixed(6),", ",U.lng.toFixed(6)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:412,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:408,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:406,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:405,columnNumber:11},void 0),e.jsxDEV(_,{onClick:Y,disabled:!U,className:"w-full bg-gradient-to-r from-lo-teal to-emerald-500 hover:from-emerald-600 hover:to-lo-teal text-white",children:["Continue to Create Lo",e.jsxDEV(De,{className:"w-4 h-4 ml-2"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:427,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:421,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:334,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:320,columnNumber:5},void 0),B=()=>{switch(t){case"type":return K();case"location":return M();case"content":return e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[e.jsxDEV("button",{onClick:()=>i("location"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsxDEV(De,{className:"w-5 h-5 text-gray-500 rotate-180"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:447,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:443,columnNumber:15},void 0),e.jsxDEV("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Your Lo"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:449,columnNumber:15},void 0),e.jsxDEV("div",{className:"w-9"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:452,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:442,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center justify-center",children:e.jsxDEV("div",{className:"inline-flex items-center space-x-2 px-3 py-1.5 bg-lo-teal/10 rounded-full",children:[e.jsxDEV(he,{className:"w-4 h-4 text-lo-teal"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:458,columnNumber:17},void 0),e.jsxDEV("span",{className:"text-sm font-medium text-gray-700",children:P||"Selected Location"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:459,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:457,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:456,columnNumber:13},void 0),m==="live"?e.jsxDEV(Yo,{isStreaming:w,onStreamStart:async I=>{if(!U){y({title:"Location required",description:"Please select a location first",variant:"destructive"});return}try{const j=await zs.startLiveStream(I,k||"Live from my location",{lat:U.lat,lng:U.lng,name:P||"Selected Location"},c);E(j),f(!0),o?.({id:j.id,content:j.title,type:"live",isLive:!0,streamUrl:j.streamUrl,location:j.location,createdAt:j.startedAt})}catch(j){y({title:"Failed to start stream",description:j.message,variant:"destructive"})}},onStreamEnd:async()=>{if(D)try{await zs.endLiveStream(D.id),f(!1),E(null),a()}catch(I){y({title:"Error ending stream",description:I.message,variant:"destructive"})}},viewerCount:D?.viewerCount||0,streamTitle:k,onTitleChange:V},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:467,columnNumber:15},void 0):e.jsxDEV(e.Fragment,{children:[m!=="media"&&e.jsxDEV("div",{children:[e.jsxDEV("textarea",{value:n,onChange:I=>r(I.target.value),placeholder:"What's happening at this location?",className:"w-full p-3 border border-gray-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-lo-teal focus:border-transparent",rows:4,maxLength:500},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:535,columnNumber:21},void 0),e.jsxDEV("div",{className:"text-right text-xs text-gray-500 mt-1",children:[n.length,"/500"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:543,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:534,columnNumber:19},void 0),m==="media"&&e.jsxDEV("div",{children:[v?e.jsxDEV("div",{className:"relative",children:[v?.type.startsWith("image/")?e.jsxDEV("img",{src:g,alt:"Preview",className:"w-full h-48 object-cover rounded-lg"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:571,columnNumber:27},void 0):e.jsxDEV("video",{src:g,className:"w-full h-48 object-cover rounded-lg",controls:!0},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:577,columnNumber:27},void 0),e.jsxDEV("button",{type:"button",onClick:H,className:"absolute top-2 right-2 p-1 bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors",children:e.jsxDEV(we,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:588,columnNumber:27},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:583,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:569,columnNumber:23},void 0):e.jsxDEV("div",{onClick:()=>b.current?.click(),className:"border-2 border-dashed border-gray-200 rounded-lg p-6 text-center cursor-pointer hover:border-lo-teal hover:bg-gray-50 transition-all",children:e.jsxDEV("div",{className:"flex flex-col items-center space-y-2",children:[e.jsxDEV("div",{className:"p-3 bg-gray-100 rounded-full",children:e.jsxDEV(as,{className:"h-6 w-6 text-gray-500"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:558,columnNumber:29},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:557,columnNumber:27},void 0),e.jsxDEV("p",{className:"text-sm text-gray-700 font-medium",children:"Add photo or video"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:560,columnNumber:27},void 0),e.jsxDEV("p",{className:"text-xs text-gray-500",children:"Max 5MB (photo) / 100MB (video)"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:563,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:556,columnNumber:25},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:552,columnNumber:23},void 0),e.jsxDEV("input",{ref:b,type:"file",accept:"image/*,video/*",onChange:L,className:"hidden"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:593,columnNumber:21},void 0),v&&e.jsxDEV("div",{className:"mt-3",children:e.jsxDEV("textarea",{value:n,onChange:I=>r(I.target.value),placeholder:"Add a caption...",className:"w-full p-3 border border-gray-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-lo-teal focus:border-transparent",rows:2,maxLength:500},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:603,columnNumber:25},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:602,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:550,columnNumber:19},void 0),e.jsxDEV("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxDEV("div",{className:"flex items-center space-x-2",children:[c?e.jsxDEV(Qs,{className:"h-4 w-4 text-orange-500"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:619,columnNumber:34},void 0):e.jsxDEV(Xs,{className:"h-4 w-4 text-lo-teal"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:619,columnNumber:81},void 0),e.jsxDEV("span",{className:"text-sm text-gray-700",children:c?"Private (Followers only)":"Public (Everyone)"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:620,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:618,columnNumber:19},void 0),e.jsxDEV("button",{type:"button",onClick:()=>x(!c),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${c?"bg-orange-500":"bg-lo-teal"}`,children:e.jsxDEV("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${c?"translate-x-6":"translate-x-1"}`},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:631,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:624,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:617,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:532,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:441,columnNumber:11},void 0);default:return null}};return e.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsxDEV("div",{className:"absolute inset-0 glass-overlay",onClick:a},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:648,columnNumber:7},void 0),e.jsxDEV("div",{className:"relative glass-card w-full max-w-lg max-h-[90vh] overflow-hidden animate-fade-in",style:{background:"rgba(255, 255, 255, 0.15)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)"},children:[e.jsxDEV("div",{className:"flex items-center justify-between p-4 glass border-b border-white/20",children:[e.jsxDEV("h2",{className:"text-lg font-semibold text-white liquid-text",children:"Create Lo"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:663,columnNumber:11},void 0),e.jsxDEV("button",{onClick:a,className:"p-1.5 glass hover:bg-white/20 rounded-full transition-all",children:e.jsxDEV(we,{className:"h-4 w-4 text-white"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:668,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:664,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:662,columnNumber:9},void 0),e.jsxDEV("form",{onSubmit:re,className:"flex flex-col h-full",children:[e.jsxDEV("div",{className:"flex-1 p-4 overflow-y-auto",children:[ee(),B()]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:674,columnNumber:11},void 0),t==="content"&&m!=="live"&&e.jsxDEV("div",{className:"flex space-x-3 p-4 border-t border-gray-200",children:[e.jsxDEV("button",{type:"button",onClick:()=>i("location"),className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors",children:"Back"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:682,columnNumber:15},void 0),e.jsxDEV("button",{type:"submit",disabled:u||!n.trim()&&!v,className:"flex-1 liquid-button disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:u?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(rr,{className:"h-4 w-4 animate-spin"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:696,columnNumber:21},void 0),e.jsxDEV("span",{children:"Posting..."},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:697,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:695,columnNumber:19},void 0):e.jsxDEV("span",{children:"Post Lo"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:700,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:689,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:681,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:672,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:654,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/post/CreateLoModal.tsx",lineNumber:646,columnNumber:5},void 0)},Wo=()=>{const{user:s}=Ae(),[a,o]=d.useState([]),[t,i]=d.useState(!1),[n,r]=d.useState(!1),m=async()=>{if(s){i(!0);try{const u=new Date(Date.now()-2592e6).toISOString(),{data:h,error:v}=await G.from("messages").select("id, content, location, created_at, expires_at, lat, lng, is_public, user_id").eq("user_id",s.id).gte("created_at",u).or("message_type.is.null,message_type.neq.event").order("created_at",{ascending:!1});if(v)throw v;o(h||[]),console.log(`üìä Found ${h?.length||0} test posts`)}catch(u){console.error("Error fetching test posts:",u),y({title:"Error fetching posts",description:u.message,variant:"destructive"})}finally{i(!1)}}},l=async u=>{try{const h=new Date(Date.now()+6048e5).toISOString(),{error:v}=await G.from("messages").update({expires_at:h}).eq("id",u);if(v)throw v;y({title:"Post extended",description:"Post expiration extended by 7 days"}),m()}catch(h){console.error("Error extending post:",h),y({title:"Error extending post",description:h.message,variant:"destructive"})}},c=async()=>{try{const u=new Date(Date.now()+6048e5).toISOString(),{error:h}=await G.from("messages").update({expires_at:u}).eq("user_id",s?.id).or("message_type.is.null,message_type.neq.event");if(h)throw h;y({title:"All posts extended! üéâ",description:`Extended ${a.length} posts by 7 days`}),m()}catch(u){console.error("Error extending posts:",u),y({title:"Error extending posts",description:u.message,variant:"destructive"})}},x=async u=>{if(confirm("Are you sure you want to delete this post?"))try{const{error:h}=await G.from("messages").delete().eq("id",u);if(h)throw h;y({title:"Post deleted",description:"Test post has been removed"}),m()}catch(h){console.error("Error deleting post:",h),y({title:"Error deleting post",description:h.message,variant:"destructive"})}};return d.useEffect(()=>{s&&n&&m()},[s,n]),n?e.jsxDEV("div",{className:"fixed bottom-4 left-4 z-40 glass-card w-80 max-h-96 overflow-y-auto",children:[e.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-white/20",children:[e.jsxDEV("h3",{className:"text-white font-semibold",children:"Test Posts Manager"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:166,columnNumber:9},void 0),e.jsxDEV("button",{onClick:()=>r(!1),className:"text-white/60 hover:text-white",children:"√ó"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:167,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:165,columnNumber:7},void 0),e.jsxDEV("div",{className:"p-3 space-y-3",children:[e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(_,{onClick:m,disabled:t,size:"sm",className:"liquid-button flex-1",children:[e.jsxDEV(ba,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:183,columnNumber:13},void 0),"Refresh"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:177,columnNumber:11},void 0),e.jsxDEV(_,{onClick:c,disabled:t||a.length===0,size:"sm",className:"glass hover:bg-white/20 text-white flex-1",children:[e.jsxDEV(Ve,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:192,columnNumber:13},void 0),"Extend All"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:186,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:176,columnNumber:9},void 0),t&&e.jsxDEV("div",{className:"text-center text-white/60 py-4",children:"Loading posts..."},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:198,columnNumber:11},void 0),!t&&a.length===0&&e.jsxDEV("div",{className:"text-center text-white/60 py-4",children:"No test posts found"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:204,columnNumber:11},void 0),a.map(u=>{const h=new Date(u.expires_at)<new Date,v=new Date(u.created_at).toLocaleDateString(),p=new Date(u.expires_at).toLocaleDateString();return e.jsxDEV("div",{className:`glass p-3 rounded-lg ${h?"border-red-500/30":"border-green-500/30"}`,children:[e.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("p",{className:"text-white text-sm font-medium truncate",children:u.content},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:221,columnNumber:19},void 0),e.jsxDEV("p",{className:"text-white/60 text-xs",children:["üìç ",u.location||"No location"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:224,columnNumber:19},void 0),e.jsxDEV("p",{className:"text-white/60 text-xs",children:["üìÖ ",v," ‚Üí ",p]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:227,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:220,columnNumber:17},void 0),e.jsxDEV("div",{className:`w-3 h-3 rounded-full ${h?"bg-red-500":"bg-green-500"}`},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:231,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:219,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex gap-1",children:[e.jsxDEV("button",{onClick:()=>l(u.id),disabled:t,className:"glass px-2 py-1 rounded text-xs text-white hover:bg-white/20 transition-all",children:e.jsxDEV(Ve,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:240,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:235,columnNumber:17},void 0),e.jsxDEV("button",{onClick:()=>x(u.id),disabled:t,className:"glass px-2 py-1 rounded text-xs text-red-400 hover:bg-red-500/20 transition-all",children:e.jsxDEV(sr,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:247,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:242,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:234,columnNumber:15},void 0)]},u.id,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:215,columnNumber:13},void 0)})]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:175,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:164,columnNumber:5},void 0):e.jsxDEV("button",{onClick:()=>r(!0),className:"fixed bottom-4 left-4 z-40 glass px-4 py-2 rounded-full text-white text-sm hover:bg-white/20 transition-all",title:"Manage Test Posts",children:[e.jsxDEV(Ge,{className:"w-4 h-4 inline mr-2"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:157,columnNumber:9},void 0),"Posts (",a.length,")"]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/components/dev/TestPostManager.tsx",lineNumber:152,columnNumber:7},void 0)},wt=()=>{const[s,a]=d.useState(!1),[o,t]=d.useState(!1),i=d.useRef(null),{addMessage:n,updateMessage:r}=ar(),{user:m}=Ae(),l=u=>{a(u),console.log("üè† HOME: Events-only mode changed to:",u)},c=()=>{t(!0),pe.emit("createMessage",void 0)},x=async u=>{if(!m){y({title:"Authentication required",description:"Please sign in to create posts",variant:"destructive"});return}try{const{error:h}=await G.from("profiles").select("id").eq("id",m.id).single();h&&h.code==="PGRST116"&&await G.from("profiles").insert({id:m.id,name:m.email?.split("@")[0]||"Anonymous",avatar_url:null});const v={content:u.content||"",user_id:m.id,lat:u.location.lat,lng:u.location.lng,location:u.location.name||null,is_public:!u.isPrivate,media_url:u.mediaUrl||null,expires_at:new Date(Date.now()+24*60*60*1e3).toISOString()},{data:p,error:g}=await G.from("messages").insert(v).select().single();if(g)throw g;if(p){const N=p.lat??u.location.lat,b=p.lng??u.location.lng,w={id:`new-${p.id}`,content:p.content??"",location:p.location??"",isPublic:!!p.is_public,timestamp:p.created_at??new Date().toISOString(),expiresAt:p.expires_at??null,mediaUrl:p.media_url??null,user:{name:m.email?.split("@")[0]||"Anonymous",avatar:m.user_metadata?.avatar_url||"/placeholder.svg"},position:{lat:N,lng:b,x:N,y:b},lat:N,lng:b,liked:!1,likes:0,isEvent:!1};n(w),pe.emit("messageCreated",{id:p.id}),setTimeout(()=>{r(w.id,{id:p.id})},2e3),setTimeout(()=>{pe.emit("refreshMessages",void 0)},120)}y({title:"Lo posted! üéâ",description:"Your Lo is now live on the map"}),t(!1)}catch(h){console.error("Error creating post:",h),y({title:"Failed to create Lo",description:"Something went wrong. Please try again.",variant:"destructive"})}};return e.jsxDEV("div",{className:"h-screen w-screen flex flex-col relative overflow-hidden",children:[e.jsxDEV("div",{className:"pointer-events-none absolute inset-x-0 top-0 z-40",children:e.jsxDEV("div",{className:"bg-gradient-to-b from-black/55 via-black/25 to-transparent px-6 pt-[calc(env(safe-area-inset-top,24px))] pb-6",children:e.jsxDEV("div",{className:"flex items-end justify-between",children:e.jsxDEV("div",{className:"pointer-events-auto",children:[e.jsxDEV("h1",{className:"text-3xl font-semibold tracking-tight text-white drop-shadow-md",children:"Lo"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:148,columnNumber:15},void 0),e.jsxDEV("p",{className:"mt-1 text-xs uppercase tracking-[0.32em] text-white/65",children:"live ‚Ä¢ local ‚Ä¢ now"},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:149,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:147,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:146,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:145,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:144,columnNumber:7},void 0),e.jsxDEV("div",{className:"flex-1 relative",children:e.jsxDEV(jr,{ref:i,isEventsOnlyMode:s},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:159,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:158,columnNumber:7},void 0),e.jsxDEV("div",{className:"absolute bottom-44 left-1/2 transform -translate-x-1/2 z-40",children:e.jsxDEV(Ho,{className:"animate-fade-in",onEventsOnlyModeChange:l},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:164,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:163,columnNumber:7},void 0),e.jsxDEV(Aa,{onPostClick:c},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:170,columnNumber:7},void 0),e.jsxDEV(Go,{isOpen:o,onClose:()=>t(!1),onPostCreated:x},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:173,columnNumber:7},void 0),e.jsxDEV(Wo,{},void 0,!1,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:180,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/akrammahmoud/geo-bubble-whispers/geo-bubble-whispers/src/pages/Home.tsx",lineNumber:142,columnNumber:5},void 0)};export{wt as default};
