import{j as e}from"./ui-DPaiNdCo.js";import{r as n,u as S,f as B}from"./vendor-Erj86lFQ.js";import{B as u,u as N,t as i}from"./index--9NxnRVI.js";import{C as T,a as W,b as z,c as M,d as D,e as H}from"./card-dL58-B1z.js";import{T as O,a as V,b as A,c as k}from"./tabs-DzTUDrSt.js";import{I as p}from"./input-B56E1p0u.js";import{L as m}from"./label-BwPas5T7.js";import{y as F,aF as G,as as _,aq as Y,ao as K,b as J,ai as Q}from"./icons-KaFMl-Yu.js";import{S as X,a as Z,b as $,c as ee,d as w}from"./select-BqNKLrJS.js";import"./supabase-ptc-ZlA7.js";import"./query-BhlUNxwW.js";import"./maps-CAbQPzAx.js";import"./index-BdQq_4o_.js";const se=({email:t,setEmail:s})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(p,{id:"email",type:"email",placeholder:"you@example.com",className:"pl-10",value:t,onChange:a=>s(a.target.value),required:!0})]})]}),te=({password:t,setPassword:s,onResetPassword:a})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"password",children:"Password"}),e.jsx(u,{variant:"link",className:"p-0 h-auto text-xs text-primary",onClick:a,type:"button",children:"Forgot password?"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(p,{id:"password",type:"password",placeholder:"••••••••",className:"pl-10",value:t,onChange:o=>s(o.target.value),required:!0})]})]}),ae=({loading:t})=>e.jsx(u,{type:"submit",className:"w-full",disabled:t,children:t?"Signing in...":e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Sign In"]})}),re=({loading:t})=>{const{signInWithGoogle:s,signInWithApple:a}=N(),o=async()=>{try{console.log("Attempting Google sign in..."),await s(),console.log("Google sign in initiated successfully")}catch(l){console.error("Google login error:",l),i({title:"Google authentication failed",description:l.message||"Unable to sign in with Google. Please check if Google OAuth is configured in Supabase.",variant:"destructive"})}},c=async()=>{try{await a()}catch(l){console.error("Apple login error:",l),i({title:"Apple authentication failed",description:l.message||"Unable to sign in with Apple",variant:"destructive"})}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Or continue with"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full",children:[e.jsxs(u,{type:"button",variant:"outline",onClick:o,disabled:t,children:[e.jsx("svg",{className:"mr-2 h-4 w-4","aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"google",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 488 512",children:e.jsx("path",{fill:"currentColor",d:"M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"})}),"Google"]}),e.jsxs(u,{type:"button",variant:"outline",onClick:c,disabled:t,children:[e.jsx("svg",{className:"mr-2 h-4 w-4","aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"apple",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",children:e.jsx("path",{fill:"currentColor",d:"M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"})}),"Apple"]})]})]})},le=({email:t})=>e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Password Reset Email Sent"}),e.jsxs("p",{className:"text-muted-foreground",children:["We've sent instructions to reset your password to ",e.jsx("span",{className:"font-medium",children:t}),"."]}),e.jsx("p",{className:"text-muted-foreground",children:"Please check your inbox and follow the instructions to reset your password."})]}),ie=({setEmail:t,email:s})=>{const[a,o]=n.useState(""),[c,l]=n.useState(!1),[x,f]=n.useState(!1),j=S(),{signIn:y,resetPassword:v}=N(),b=async d=>{if(d.preventDefault(),!s||!a){i({title:"Error",description:"Please fill in all fields",variant:"destructive"});return}try{l(!0),await y(s,a),i({title:"Welcome back!",description:"You've successfully signed in"}),j("/home")}catch(h){console.error("Login error:",h),i({title:"Authentication failed",description:h.message||"Please check your credentials and try again",variant:"destructive"})}finally{l(!1)}},g=async d=>{if(d.preventDefault(),!s){i({title:"Email required",description:"Please enter your email address first",variant:"destructive"});return}try{l(!0),await v(s),f(!0),i({title:"Password reset email sent",description:"Please check your email for instructions to reset your password"})}catch(h){console.error("Password reset error:",h),i({title:"Password reset failed",description:h.message||"Unable to send password reset email",variant:"destructive"})}finally{l(!1)}};return x?e.jsx(le,{email:s}):e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsx(se,{email:s,setEmail:t}),e.jsx(te,{password:a,setPassword:o,onResetPassword:g}),e.jsx(ae,{loading:c}),e.jsx(re,{loading:c})]})},ne=({setEmail:t,email:s})=>{const[a,o]=n.useState(""),[c,l]=n.useState(""),[x,f]=n.useState(""),[j,y]=n.useState(""),[v,b]=n.useState(""),[g,d]=n.useState(!1),[h,C]=n.useState(!1),{signUp:L,signInWithGoogle:I,signInWithApple:E}=N(),R=async r=>{if(r.preventDefault(),!s||!a||!c){i({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}try{d(!0),await L(s,a,{name:c,username:s.split("@")[0],phone:x,location:j,gender:v}),C(!0),i({title:"Account created",description:"Please check your email to confirm your registration"})}catch(P){console.error("Signup error:",P),i({title:"Registration failed",description:P.message||"Unable to create your account",variant:"destructive"})}finally{d(!1)}},U=async()=>{try{d(!0),await I()}catch(r){console.error("Google login error:",r),i({title:"Google authentication failed",description:r.message||"Unable to sign in with Google",variant:"destructive"}),d(!1)}},q=async()=>{try{d(!0),await E()}catch(r){console.error("Apple login error:",r),i({title:"Apple authentication failed",description:r.message||"Unable to sign in with Apple",variant:"destructive"}),d(!1)}};return h?e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Verification Email Sent"}),e.jsxs("p",{className:"text-muted-foreground",children:["We've sent a confirmation email to ",e.jsx("span",{className:"font-medium",children:s}),"."]}),e.jsx("p",{className:"text-muted-foreground",children:"Please check your inbox and click the verification link to complete your registration."}),e.jsx(u,{variant:"outline",className:"w-full mt-4",onClick:()=>C(!1),children:"Back to Register"})]}):e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{htmlFor:"name",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(p,{id:"name",placeholder:"Your Name",className:"pl-10",value:c,onChange:r=>l(r.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{htmlFor:"register-email",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(p,{id:"register-email",type:"email",placeholder:"you@example.com",className:"pl-10",value:s,onChange:r=>t(r.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{htmlFor:"register-password",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(p,{id:"register-password",type:"password",placeholder:"••••••••",className:"pl-10",value:a,onChange:r=>o(r.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"phone",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(p,{id:"phone",type:"tel",placeholder:"+1 (555) 123-4567",className:"pl-10",value:x,onChange:r=>f(r.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"location",children:"Location"}),e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(p,{id:"location",placeholder:"City, Country",className:"pl-10",value:j,onChange:r=>y(r.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"gender",children:"Gender"}),e.jsxs(X,{value:v,onValueChange:b,children:[e.jsx(Z,{children:e.jsx($,{placeholder:"Select your gender"})}),e.jsxs(ee,{children:[e.jsx(w,{value:"male",children:"Male"}),e.jsx(w,{value:"female",children:"Female"}),e.jsx(w,{value:"other",children:"Other"}),e.jsx(w,{value:"prefer_not_to_say",children:"Prefer not to say"})]})]})]}),e.jsx(u,{type:"submit",className:"w-full",disabled:g,children:g?"Creating account...":e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Create Account"]})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Or continue with"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full",children:[e.jsxs(u,{type:"button",variant:"outline",onClick:U,disabled:g,children:[e.jsx("svg",{className:"mr-2 h-4 w-4","aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"google",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 488 512",children:e.jsx("path",{fill:"currentColor",d:"M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"})}),"Google"]}),e.jsxs(u,{type:"button",variant:"outline",onClick:q,disabled:g,children:[e.jsx("svg",{className:"mr-2 h-4 w-4","aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"apple",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",children:e.jsx("path",{fill:"currentColor",d:"M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"})}),"Apple"]})]})]})},oe=()=>{const[t,s]=n.useState(""),a=S();return e.jsxs(T,{children:[e.jsxs(W,{className:"space-y-1",children:[e.jsx(z,{className:"text-2xl flex justify-center",children:e.jsx("img",{src:"/lovable-uploads/75b652b2-23ff-4231-8935-6f15e4221203.png",alt:"Lo Logo",className:"h-24"})}),e.jsx(M,{className:"text-center",children:"Sign in to your account or create a new one"})]}),e.jsx(D,{className:"p-0",children:e.jsxs(O,{defaultValue:"login",className:"w-full",children:[e.jsxs(V,{className:"grid w-full grid-cols-2",children:[e.jsx(A,{value:"login",children:"Login"}),e.jsx(A,{value:"register",children:"Register"})]}),e.jsx(k,{value:"login",className:"p-6 pt-4",children:e.jsx(ie,{setEmail:s,email:t})}),e.jsx(k,{value:"register",className:"p-6 pt-4",children:e.jsx(ne,{setEmail:s,email:t})})]})}),e.jsx(H,{className:"flex flex-col items-center p-6 pt-0",children:e.jsx(u,{variant:"outline",className:"w-full mt-4",onClick:()=>a("/"),children:"Back to Home"})})]})},ye=()=>{const t=S(),s=B(),{user:a,loading:o,isNewUser:c}=N();return n.useEffect(()=>{const l=new URLSearchParams(s.search),x=l.get("error"),f=l.get("error_description");x&&i({title:"Authentication error",description:f||"There was a problem with authentication",variant:"destructive"})},[s.search]),n.useEffect(()=>{!o&&a&&t(c?"/profile-setup":"/home")},[a,o,c,t]),o?e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gray-50",children:e.jsx("div",{className:"w-full max-w-md text-center",children:e.jsx("p",{className:"text-lg",children:"Loading..."})})}):e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gray-50",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsx(oe,{})})})};export{ye as default};
