import{j as e}from"./ui-DPaiNdCo.js";import{u as M,r as i}from"./vendor-Erj86lFQ.js";import{u as I,s as m,B as c,t as o}from"./index--9NxnRVI.js";import{B as g}from"./BottomNavigation-D2RT3nlO.js";import{A as q,a as z,b as U}from"./avatar-mWBahg0l.js";import{T as D,a as G,b as j,c as b}from"./tabs-DzTUDrSt.js";import{t as p,A as H,C as J,s as R,a as N,b as Y,_ as V,aa as W,ab as y,a8 as K,ac as O,ad as Q}from"./icons-KaFMl-Yu.js";import"./supabase-ptc-ZlA7.js";import"./query-BhlUNxwW.js";import"./maps-CAbQPzAx.js";const oe=()=>{const v=M(),{user:a}=I(),[t,x]=i.useState(null),[w,C]=i.useState([]),[h,k]=i.useState({posts:0,followers:0,following:0}),[S,P]=i.useState(!0),[_,A]=i.useState("posts"),[d,E]=i.useState(!1),[u,f]=i.useState("");i.useEffect(()=>{a&&(T(),B())},[a]);const T=async()=>{if(a)try{const{data:s,error:r}=await m.from("profiles").select("*").eq("id",a.id).single();if(r&&r.code==="PGRST116"){const{data:n,error:l}=await m.from("profiles").insert({id:a.id,name:a.email?.split("@")[0]||"Anonymous",bio:"Hey there! I'm new to Lo ðŸ‘‹",avatar_url:null}).select().single();!l&&n&&(x(n),f(n.bio||""))}else s&&(x(s),f(s.bio||""))}catch(s){console.error("Error loading profile:",s)}finally{P(!1)}},B=async()=>{if(a)try{const{data:s,error:r}=await m.from("messages").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});if(s){const n=s.map(l=>({id:l.id,media_url:l.media_url,content:l.content,created_at:l.created_at,likes:Math.floor(Math.random()*100),comments:Math.floor(Math.random()*50),type:l.media_url?"image":"text"}));C(n),k(l=>({...l,posts:s.length}))}}catch(s){console.error("Error loading posts:",s)}},L=async()=>{if(d)try{const{error:s}=await m.from("profiles").update({bio:u}).eq("id",a?.id);s||(o({title:"Profile updated!",description:"Your bio has been saved"}),x(r=>({...r,bio:u})))}catch(s){console.error("Error updating bio:",s)}E(!d)},F=async s=>{!s.target.files?.[0]||!a||o({title:"Avatar upload",description:"Avatar upload coming soon!"})};return a?S?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white flex items-center justify-center",children:[e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full mx-auto mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 mx-auto mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24 mx-auto"})]}),e.jsx(g,{})]}):e.jsxs("div",{className:"min-h-screen bg-white pb-20",children:[e.jsx("div",{className:"sticky top-0 bg-white/95 backdrop-blur-xl border-b border-gray-200/50 z-50",style:{paddingTop:"env(safe-area-inset-top, 0px)"},children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>v("/"),className:"h-10 w-10 rounded-full",children:e.jsx(H,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h1",{className:"text-xl font-bold",children:t?.name||a.email?.split("@")[0]}),e.jsx(J,{className:"h-5 w-5 text-blue-500"})]}),e.jsx(c,{variant:"ghost",size:"icon",className:"h-10 w-10 rounded-full",children:e.jsx(R,{className:"h-5 w-5"})})]})})}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(q,{className:"h-24 w-24 ring-3 ring-gradient-to-r from-lo-teal to-blue-500 ring-offset-2",children:[e.jsx(z,{src:t?.avatar_url}),e.jsx(U,{className:"bg-gradient-to-r from-lo-teal to-blue-500 text-white text-2xl font-bold",children:(t?.name||a.email||"U")[0].toUpperCase()})]}),e.jsxs("label",{htmlFor:"avatar-upload",className:"absolute -bottom-1 -right-1 h-8 w-8 bg-gradient-to-r from-lo-teal to-blue-500 rounded-full flex items-center justify-center cursor-pointer shadow-lg",children:[e.jsx(N,{className:"h-4 w-4 text-white"}),e.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:F})]})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex justify-around",children:[e.jsxs("button",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:h.posts}),e.jsx("p",{className:"text-sm text-gray-500",children:"Posts"})]}),e.jsxs("button",{className:"text-center",onClick:()=>o({title:"Followers",description:"Coming soon!"}),children:[e.jsx("p",{className:"text-2xl font-bold",children:h.followers}),e.jsx("p",{className:"text-sm text-gray-500",children:"Followers"})]}),e.jsxs("button",{className:"text-center",onClick:()=>o({title:"Following",description:"Coming soon!"}),children:[e.jsx("p",{className:"text-2xl font-bold",children:h.following}),e.jsx("p",{className:"text-sm text-gray-500",children:"Following"})]})]})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h2",{className:"font-bold text-base",children:t?.name||a.email?.split("@")[0]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["@",t?.username||a.email?.split("@")[0]]}),d?e.jsx("textarea",{value:u,onChange:s=>f(s.target.value),className:"mt-2 w-full p-2 border rounded-lg text-sm resize-none",rows:3,placeholder:"Write something about yourself...",maxLength:150}):e.jsx("p",{className:"mt-2 text-sm",children:t?.bio||"No bio yet"}),t?.location&&e.jsxs("div",{className:"flex items-center mt-2 text-sm text-gray-500",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:t.location})]}),e.jsxs("div",{className:"flex items-center mt-2 text-sm text-gray-500",children:[e.jsx(V,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:["Joined ",new Date(t?.created_at||Date.now()).toLocaleDateString("en-US",{month:"long",year:"numeric"})]})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-4",children:[e.jsx(c,{onClick:L,className:"flex-1 bg-gray-100 hover:bg-gray-200 text-black border-0 rounded-lg py-2",children:d?"Save Bio":"Edit Profile"}),e.jsx(c,{onClick:()=>o({title:"Share Profile",description:"Coming soon!"}),className:"flex-1 bg-gray-100 hover:bg-gray-200 text-black border-0 rounded-lg py-2",children:"Share Profile"})]}),e.jsxs("div",{className:"flex space-x-4 mt-6 overflow-x-auto",children:[e.jsxs("button",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full border-2 border-dashed border-gray-300 flex items-center justify-center",children:e.jsx(N,{className:"h-6 w-6 text-gray-400"})}),e.jsx("span",{className:"text-xs mt-1",children:"New"})]}),["Travel","Food","Events"].map((s,r)=>e.jsxs("button",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-lo-teal to-blue-500 p-0.5",children:e.jsx("div",{className:"w-full h-full bg-white rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-lo-teal/20 to-blue-500/20 rounded-full"})})}),e.jsx("span",{className:"text-xs mt-1",children:s})]},r))]})]}),e.jsxs(D,{value:_,onValueChange:A,className:"w-full",children:[e.jsxs(G,{className:"w-full grid grid-cols-3 h-12 p-0 bg-transparent border-t border-gray-200",children:[e.jsx(j,{value:"posts",className:"data-[state=active]:border-t-2 data-[state=active]:border-black rounded-none",children:e.jsx(W,{className:"h-5 w-5"})}),e.jsx(j,{value:"saved",className:"data-[state=active]:border-t-2 data-[state=active]:border-black rounded-none",children:e.jsx(y,{className:"h-5 w-5"})}),e.jsx(j,{value:"tagged",className:"data-[state=active]:border-t-2 data-[state=active]:border-black rounded-none",children:e.jsx(p,{className:"h-5 w-5"})})]}),e.jsx(b,{value:"posts",className:"mt-0 p-0",children:e.jsx("div",{className:"grid grid-cols-3 gap-0.5",children:w.length>0?w.map(s=>e.jsxs("button",{className:"relative aspect-square bg-gray-100 overflow-hidden group",onClick:()=>o({title:"Post details",description:"Coming soon!"}),children:[s.media_url?e.jsx("img",{src:s.media_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:e.jsx("p",{className:"text-xs text-gray-500 p-2 text-center line-clamp-3",children:s.content})}),e.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center space-x-4",children:[e.jsxs("div",{className:"flex items-center text-white",children:[e.jsx(K,{className:"h-5 w-5 mr-1 fill-white"}),e.jsx("span",{className:"font-bold",children:s.likes})]}),e.jsxs("div",{className:"flex items-center text-white",children:[e.jsx(O,{className:"h-5 w-5 mr-1 fill-white"}),e.jsx("span",{className:"font-bold",children:s.comments})]})]}),s.type==="video"&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(Q,{className:"h-5 w-5 text-white drop-shadow"})})]},s.id)):e.jsxs("div",{className:"col-span-3 py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Share your first Lo"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Your posts will appear here"})]})})}),e.jsx(b,{value:"saved",className:"mt-0 p-0",children:e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(y,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Saved posts"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Save posts to view them later"})]})}),e.jsx(b,{value:"tagged",className:"mt-0 p-0",children:e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(p,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Tagged posts"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Posts you're tagged in will appear here"})]})})]}),e.jsx(g,{})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white flex items-center justify-center",children:[e.jsxs("div",{className:"text-center px-6",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-r from-lo-teal to-blue-500 rounded-full flex items-center justify-center",children:e.jsx(p,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Sign in to view your profile"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Join Lo to share your moments with the world"}),e.jsx(c,{onClick:()=>v("/auth"),className:"bg-gradient-to-r from-lo-teal to-blue-500 hover:from-lo-teal/90 hover:to-blue-500/90 text-white border-0 shadow-lg px-8 py-3 rounded-full",children:"Sign In"})]}),e.jsx(g,{})]})};export{oe as default};
